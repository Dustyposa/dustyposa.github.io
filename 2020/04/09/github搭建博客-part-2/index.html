<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="一些经验的记录。"><meta name="author" content="Dusty Posa"><meta name="keywords" content="python,python3,process,script"><title>从零开始搭建Github博客(其二) - Posaのにわ</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"><link rel="stylesheet" href="/css/main.css"><link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><meta name="generator" content="Hexo 4.2.0"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Posaのにわ</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/">标签</a></li><li class="nav-item"><a class="nav-link" href="/about/">关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask rgba-black-light flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><p class="mt-3 post-meta"><i class="fas fa-calendar-alt" aria-hidden="true"></i> 星期四, 四月 9日 2020, 10:28 上午</p><p class="mt-1"><span class="post-meta"><i class="far fa-chart-bar"></i> 1.6k 字 </span><span class="post-meta"><i class="far fa-clock"></i> 5 分钟</span></p></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><div class="markdown-body"><h1 id="搭建-github-博客之旅-（Part-2）"><a href="#搭建-github-博客之旅-（Part-2）" class="headerlink" title="搭建 github 博客之旅 （Part 2）"></a>搭建 github 博客之旅 （Part 2）</h1><p>在第一部分，我们介绍了如何搭建一个免费博客并部署在 <code>Github</code> 上面，但是我们还有很多可以优化（更懒）的地方，例如：</p><ul><li><a href="#自动化部署-CI-CD">自动部署（非一键部署）</a></li><li><a href="#更换主题">主题更换（换个漂亮的皮肤）</a></li><li>性能优化（带宽，响应太慢？）</li><li>加点料</li><li>etc…</li></ul><p>那么，话不多说，开始正题。</p><h2 id="自动化部署-CI-CD"><a href="#自动化部署-CI-CD" class="headerlink" title="自动化部署-CI/CD"></a>自动化部署-CI/CD</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>我们简述一下我们目前的部署流程：</p><blockquote><p>在 writing 编写文章, 编写完成后，运行<br><code>$ hexo g &amp; d</code><br>长篇文章写好之后，这点操作没什么太大负担，但是如果进行小调整的话每次都要输这些命令，那就很麻烦了。<br>那么我们思考一下，写完文章后输入命令发布，<br>命令是不变的，那么我们这里肯定可以<strong>自动化</strong>。<br>那么，关键问题是如何确定文章写完了？毕竟不可能每次写一半，或者写一点就自动发布，我们就需要一个<strong>自动发布触发点</strong>。<br><code>git</code> 比较好想，我们触发点使用 <code>push</code> 或者 分支更新即可。<br>看起来很简单，如何实现呢？<br>这时候就可以祭出我们的利器了 - <code>Travis Ci</code>！</p></blockquote><details><summary>CI/CD 是什么?</summary><p>这里自动部署，用到了一个概念 <code>CI/CD (持续集成/持续部署)</code>。<br>简单来说，就是让开发部署自动化，我们设置一个流程，对每次发布后的代码都进行相同的操作（比如：运行测试之类，当然测试完成后，我们也可以自动合并或者自动部署）。<br>这里，我们的项目比较简单，我们做到自动部署即可。让我们管理博客更加轻松。</p><blockquote><p>wiki解释：<br>在软件工程中，CI / CD或CICD通常是指持续集成与持续交付或持续部署的组合实践。在企业沟通的上下文中，CI / CD还可以指代企业标识和企业设计的整个过程。</p></blockquote></details><h3 id="Travis-Ci-安装"><a href="#Travis-Ci-安装" class="headerlink" title="Travis Ci 安装"></a>Travis Ci 安装</h3><h4 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h4><details><summary>Travis 是什么</summary><blockquote><p>Travis CI是在软件开发领域中的一个在线的，分布式的持续集成服务，用来构建及测试在GitHub托管的代码。这个软件的代码同时也是开源的，可以在GitHub上下载到，尽管开发者当前并不推荐在闭源项目中单独使用它</p></blockquote><p>简单的说，就是针对 <code>GitHub</code> 的 <code>CI</code>，也就是我们要的 <code>CI</code> 工具了，你应该也在很多仓库看到过这个工具，一般就叫 <code>traviscibot</code>。<br>like this：<br><img src="https://i.loli.net/2020/04/09/RkIPD9piuQjCfG3.png" srcset="/img/loading.gif" alt="image.png"></p></details><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul><li><h4 id="a-把-Travis-CI-添加到你的-GitHub-账户中。"><a href="#a-把-Travis-CI-添加到你的-GitHub-账户中。" class="headerlink" title="a. 把 Travis CI 添加到你的 GitHub 账户中。"></a>a. 把 <code>Travis CI</code> 添加到你的 <code>GitHub</code> 账户中。</h4>打开 <a href="https://github.com/marketplace/travis-ci" target="_blank" rel="noopener">Travis CI</a> 安装页面。<br>选择免费安装（只适合于开源项目）<br><img src="https://i.loli.net/2020/04/09/HfkOcwTMa2sVWJ8.png" srcset="/img/loading.gif" alt="image.png"></li></ul><ul><li><h4 id="b-配置-Travis-CI-权限。"><a href="#b-配置-Travis-CI-权限。" class="headerlink" title="b. 配置 Travis CI 权限。"></a>b. 配置 <code>Travis CI</code> 权限。</h4><p>前往 <code>GitHub</code> 的 <a href="https://github.com/settings/installations" target="_blank" rel="noopener">Applications settings</a>，配置 <code>Travis CI</code> 权限，使其能够访问你的 <code>repository</code>。</p><blockquote><p>待补图</p></blockquote><p>你应该会被重定向到 <code>Travis CI</code> 的页面。如果没有，请 <a href="https://travis-ci.com/" target="_blank" rel="noopener">手动前往</a>。</p><p>在浏览器新建一个标签页，前往 GitHub 新建 <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">Personal Access Token</a>，只勾选 <code>repo</code> 的权限并生成一个新的 Token。Token 生成后请复制并保存好。<br>回到 Travis CI，前往你的 repository 的设置页面，在 <strong>Environment Variables</strong> 下新建一个环境变量，<strong>Name</strong> 为 <code>GH_TOKEN</code>，<strong>Value</strong> 为刚才你在 GitHub 生成的 Token。确保 <strong>DISPLAY VALUE IN BUILD LOG</strong> 保持 <strong>不被勾选</strong> 避免你的 Token 泄漏。点击 <code>Add</code> 保存。</p></li></ul><ul><li><h4 id="c-编写自动部署脚本"><a href="#c-编写自动部署脚本" class="headerlink" title="c. 编写自动部署脚本"></a>c. 编写自动部署脚本</h4><p>新建一个 <code>.travis.yml</code> 的文件:</p><pre><code class="yaml"> sudo: false
language: node_js
node_js:
    - 10 # use nodejs v10 LTS
cache: npm
install:
    - cd blog &amp;&amp; npm i
# 限制使用 travis 的分支
branches:
    only:
        - writing
script:
    - hexo clean
    - hexo generate # generate static files
deploy:
    provider: pages
    skip-cleanup: true
    github-token: $GH_TOKEN
    target-branch: master  # 目标分支
    keep-history: true
    on:
      branch: writing  # 在哪个分支运行脚本
    local-dir: docs/public  # 部署的文件夹
</code></pre><p>这样在我们的自动部署就差不多完成了，我们将配置好的文件 <code>push</code> 上去。稍等片刻，就能看到自动部署详情了。</p></li></ul><h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><p>默认主题的 <code>hexo</code> 比较单调，一点都不炫酷。自然，换肤的需求就诞生了。到现在，<code>hexo</code> 也有了很多炫酷的主题可选，在这里，我推荐一个 <code>Material Design</code> 风格的主题 <a href="https://hexo.fluid-dev.com/docs/guide/#%E4%B8%BB%E9%A2%98%E7%AE%80%E4%BB%8B" target="_blank" rel="noopener"><code>flud</code></a><br>当然也有很多其他主题可选，在<a href="https://hexo.io/themes/" target="_blank" rel="noopener">这里</a>可以看，使用方式基本一致，依葫芦画瓢即可。</p><h3 id="安装-flud"><a href="#安装-flud" class="headerlink" title="安装 flud"></a>安装 flud</h3><p>下载 <a href="https://github.com/fluid-dev/hexo-theme-fluid/releases" target="_blank" rel="noopener">最新 release 版本</a>，<code>master</code> 分支无法保证稳定。<br>下载后解压到 <code>themes</code> 目录下并重命名为 <code>fluid</code>。<br>结果如下图：<br><img src="https://i.loli.net/2020/04/09/IaOnpSDxCGYFeUK.png" srcset="/img/loading.gif" alt="image.png"></p><h3 id="更换主题-1"><a href="#更换主题-1" class="headerlink" title="更换主题"></a>更换主题</h3><p>更换主题也很简单，我们更改 <code>hexo</code> 配置文件即可。<br>打开 <code>docs/_config.yml</code> (即博客目录下的该配置文件),更改下面的配置：</p><pre><code>
theme: fluid  # 指定主题

language: zh-CN  # 指定语言，可不改</code></pre><p>这样我们重新运行<br><code>hexo s</code><br>就能看到我们新的主题了！参考效果如下：</p><blockquote><p>待补图</p></blockquote><p>整个操作也很简单，但是需要定制化操作的话，看<a href="https://hexo.fluid-dev.com/docs/guide" target="_blank" rel="noopener">官方文档</a>即可～非常详细。</p><h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>由于我们的带宽是有限的，那么如果传递的资源太大，响应就会很慢。大家可以测试一下，<strong>更换一下</strong> <code>banner</code> 图片，<strong>部署</strong>后再次访问，就会发现很慢很慢。这也非常影响用户体验。</p><p>那么如何解决呢？<br>很明显，我们至少有两种解决办法：</p><ul><li><del>a. 加带宽</del> （什么？加带宽？那是不可能的，服务器都是白嫖的，还想我加带宽？？？）</li><li>b. 减少从<strong>自身</strong>服务器传输的数据量（注意加粗部分）<br>这里我们可以再分出两种思路<ul><li><strong>1. 减少自身服务器传输的数据大小（例如: 文本文件数据，图片数据之类）</strong></li><li><strong>2. 将数据放到其他地方，远程获取（例如： CDN，文件服务器，图床等等）</strong></li></ul></li></ul><p>那么，我们就简单介绍一下这两种方法，顺便对我们的博客网站进行优化。</p><h3 id="文件压缩"><a href="#文件压缩" class="headerlink" title="文件压缩"></a>文件压缩</h3><h4 id="a-文本文件压缩"><a href="#a-文本文件压缩" class="headerlink" title="a. 文本文件压缩"></a>a. 文本文件压缩</h4><p>这个我们列举一种方式，用压缩插件完成即可。</p><ul><li>安装插件 <code>hexo-all-minifier</code><pre><code>npm install hexo-all-minifier --save</code></pre><blockquote><p>mac 用户可能需要安装其他东西<br><code>brew install libtool automake autoconf nasm</code></p></blockquote></li></ul><h3 id="图片生成"><a href="#图片生成" class="headerlink" title="图片生成"></a>图片生成</h3><p><a href="https://favicon.io" target="_blank" rel="noopener">https://favicon.io</a></p><blockquote><p>参考资料：<br><a href="https://hexo.io/zh-cn/docs/github-pages" target="_blank" rel="noopener">hexo 文档</a><br><a href="https://hexo.fluid-dev.com/docs/guide/#%E5%85%B3%E4%BA%8E%E6%8C%87%E5%8D%97" target="_blank" rel="noopener">fluid 文档</a></p></blockquote></div><hr><div><p><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/blog/">blog</a> &nbsp; </span>&nbsp;&nbsp; <span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/github-pages/">github_pages</a> <a class="hover-with-bg" href="/tags/hexo/">hexo</a></span></p><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p><div class="post-prevnext row"><div class="post-prev col-6"></div><div class="post-next col-6"><a href="/2020/04/07/github%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2-part-1/"><span class="hidden-mobile">从零开始搭建Github博客(其一)</span> <span class="visible-mobile">下一篇</span> <i class="fa fa-chevron-right"></i></a></div></div></div><div class="comments" id="comments"></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc-start"></div><div id="toc"><p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div></main><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><b>Fluid</b></a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script><script>$(document).ready(function(){var s=$("#navbar").height(),c=$("#toc"),t=$("#board-ctn"),o=t.offset().top,i=2*o+t.height();$(window).scroll(function(){var t=$("#toc-start").offset().top-s,o=document.body.scrollTop+document.documentElement.scrollTop;t<=o&&o<=i?c.css({display:"block",position:"fixed",top:s}):o<=t?c.css({position:"",top:""}):i<o&&c.css("display","none")}),tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,headingsOffset:-o}),0<$(".toc-list-item").length&&$("#toc > p").css("visibility","visible");var l=t.css("margin-right");$("#toc-ctn").css({right:l})})</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script><script>$(document).ready(function(){$("pre").addClass("prettyprint  "),prettyPrint()})</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","从零开始搭建Github博客(其二)&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#post img:not(.no-zoom img, img[no-zoom])").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script></body></html>