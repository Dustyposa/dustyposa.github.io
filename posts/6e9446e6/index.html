<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="ä¸€äº›ç»éªŒçš„è®°å½•ã€‚"><meta name="author" content="Dusty Posa"><meta name="keywords" content="python,python3,process,script"><title>python ç¼–å†™å¤šè¿›ç¨‹ socket webé™æ€æœåŠ¡å™¨ - Posaã®ã«ã‚</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"><link rel="stylesheet" href="/css/main.css"><link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><meta name="generator" content="Hexo 4.2.0"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Posaã®ã«ã‚</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/">å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/">åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/">æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="/about/">å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(https://i.loli.net/2020/04/14/smYH5uD8Pb7k4oI.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask rgba-black-light flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><p class="mt-3 post-meta"><i class="fas fa-calendar-alt" aria-hidden="true"></i> æ˜ŸæœŸä¸€, å››æœˆ 6æ—¥ 2020, 11:12 ä¸Šåˆ</p><p class="mt-1"><span class="post-meta"><i class="far fa-chart-bar"></i> 1.4k å­— </span><span class="post-meta"><i class="far fa-clock"></i> 6 åˆ†é’Ÿ</span></p></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><p class="note note-warning">æœ¬æ–‡æœ€åæ›´æ–°äºï¼šæ˜ŸæœŸä¸‰, äº”æœˆ 13æ—¥ 2020, 3:07 ä¸‹åˆ</p><div class="markdown-body"><h3 id="æœåŠ¡å™¨æ¨¡å‹-C-Sæ¨¡å‹"><a href="#æœåŠ¡å™¨æ¨¡å‹-C-Sæ¨¡å‹" class="headerlink" title="æœåŠ¡å™¨æ¨¡å‹ C/Sæ¨¡å‹"></a>æœåŠ¡å™¨æ¨¡å‹ C/Sæ¨¡å‹</h3><p><strong>socket</strong> æ˜¯ä»€ä¹ˆ ï¼Ÿ<br><strong>ä¸€ç§è¿›ç¨‹é—´çš„é€šä¿¡æŠ€æœ¯ ç”±ä¼¯å…‹åˆ©å¤§å­¦ï¼ˆBSDï¼‰ å‘æ˜ï¼Œ æ‰æœ‰äº†å½“å‰çš„äº’è”ç½‘</strong></p><p><strong>å‡ ä¹æ‰€æœ‰çš„C/Sæ¨¡å‹æœåŠ¡å™¨ï¼Œ åº•å±‚éƒ½æ˜¯socketå®ç°çš„ï¼Œ webæœåŠ¡å™¨ä¹Ÿä¸ä¾‹å¤–ï¼Œ åªæ˜¯webæœåŠ¡å™¨ç”¨äº†ï¼š</strong></p><h4 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a><strong>HTTPåè®®</strong></h4><a id="more"></a><p>ç”¨pythonæ­å»ºç®€æ˜“çš„webæœåŠ¡å™¨ï¼š</p><h4 id="1-å¯¼å…¥ç›¸å…³æ¨¡å—"><a href="#1-å¯¼å…¥ç›¸å…³æ¨¡å—" class="headerlink" title="1. å¯¼å…¥ç›¸å…³æ¨¡å—"></a>1. å¯¼å…¥ç›¸å…³æ¨¡å—</h4><pre><code class="python">import os  # å¯¼å…¥ç³»ç»Ÿæ¨¡å—
import socket  # å¯¼å…¥ socketåŒ…
from multiprocessing import Process  # å¯¼å…¥å¤šè¿›ç¨‹æ¨¡å—</code></pre><h4 id="2-åˆ›å»ºç±»å¹¶åˆå§‹åŒ–"><a href="#2-åˆ›å»ºç±»å¹¶åˆå§‹åŒ–" class="headerlink" title="2. åˆ›å»ºç±»å¹¶åˆå§‹åŒ–"></a>2. åˆ›å»ºç±»å¹¶åˆå§‹åŒ–</h4><p><strong>åˆå§‹åŒ–å‡ºéƒ¨åˆ†éœ€è¦çš„å±æ€§ æ–¹ä¾¿ä¹‹åæ–¹æ³•çš„ä½¿ç”¨</strong><br>port ä¸»æœºéœ€è¦ç»‘å®šçš„ç«¯å£</p><pre><code class="python">class WebServer(object):
    BASE_DIR = os.path.join(os.getcwd(), &#39;static&#39;)  # æŸ¥è¯¢æ–‡ä»¶å¤¹ï¼Œ ç”¨æ¥æŸ¥æ‰¾è®¿é—®çš„æ–‡ä»¶
    RESPONSE_STATUS = {200: &#39;OK&#39;, 404: &#39;Not Found&#39;, 403: &#39;Forbid&#39;}  # è®¾ç½®å“åº”è¡Œå¯é€‰è¿”å›çŠ¶æ€ç ï¼Œ åªé€‰æ‹©äº†éƒ¨åˆ†åšæ¼”ç¤º

    def __init__(self, port=8080):
        &quot;&quot;&quot;
        åˆå§‹åŒ–å‚æ•°
        :param port:
        &quot;&quot;&quot;
        self.soc = self.create_server(port)  # åˆå§‹åŒ–socketå¯¹è±¡
        self.new_fd: socket.socket = ...  # æ–¹ä¾¿pycharmæç¤º,é˜²æ­¢pycharmæŠ¥æ³¢æµªçº¿
        self.request_dict = {}  # è®¾ç½®ç©ºå­—å…¸ï¼Œ ç”¨äºå­˜å‚¨å¤„ç†è¿‡åçš„è¯·æ±‚å¤´
        self.response_dict = [(&#39;Server&#39;, &#39;my_server&#39;), (&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;)]  # è®¾ç½®å“åº”å¤´ï¼Œå› ä¸ºå¯èƒ½æœ‰å¤šä¸ªSet-Cookieï¼Œ æ‰€ä»¥ç”¨åˆ—è¡¨ä¸­çš„å…ƒç»„å­˜å‚¨</code></pre><h4 id="3-åˆå§‹åŒ–socketå¯¹è±¡-å›ºå®šå››éƒ¨æ›²"><a href="#3-åˆå§‹åŒ–socketå¯¹è±¡-å›ºå®šå››éƒ¨æ›²" class="headerlink" title="3. åˆå§‹åŒ–socketå¯¹è±¡ å›ºå®šå››éƒ¨æ›²"></a>3. åˆå§‹åŒ–socketå¯¹è±¡ å›ºå®šå››éƒ¨æ›²</h4><ol><li>åˆ›å»ºsocketå¯¹è±¡</li><li>ç»‘å®šaddressï¼Œ ipåŠç«¯å£</li><li>é˜²æ­¢æœåŠ¡å™¨å¼‚å¸¸æ—¶ï¼Œ ç«¯å£çš„å ç”¨ï¼Œ å½±å“æœåŠ¡å™¨çš„é‡å¯</li><li>è½¬æˆç›‘å¬æ¨¡å¼<pre><code class="python"> # åˆ›å»ºsocketå¯¹è±¡
 def create_server(self, port):
     &quot;&quot;&quot;
     ç”¨æ¥åˆå§‹åŒ–serverå¯¹è±¡
     :return:
     &quot;&quot;&quot;
     self.soc = socket.socket()  # åˆ›å»ºsocketå¯¹è±¡
     self.soc.bind((&#39;&#39;, port))  # ç»‘å®šå¥—æ¥å­—åˆ°addressï¼Œ ä¸€èˆ¬ä¸º ip+portï¼Œ å¹¶ä¸”hostä¸€èˆ¬æ˜¯127.0.0.1æˆ–è€…ä¸å¡«(ç­‰å†…æ ¸åˆ†é…)ï¼Œä¸€èˆ¬æ— æƒç»‘å®šéæœ¬æœºip
     self.soc.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)  # æ¥ç»­æœåŠ¡å™¨çªç„¶å®•æ‰æ—¶ï¼Œç«¯å£æš‚æ—¶ä¸èƒ½ä½¿ç”¨çš„é—®é¢˜
     self.soc.listen(5)  # è½¬ä¸ºç›‘å¬çŠ¶æ€ æœåŠ¡å™¨å¿…é¡»
     return self.soc</code></pre><h4 id="4-å¤šè¿›ç¨‹æ¥å—è¯·æ±‚"><a href="#4-å¤šè¿›ç¨‹æ¥å—è¯·æ±‚" class="headerlink" title="4. å¤šè¿›ç¨‹æ¥å—è¯·æ±‚"></a>4. å¤šè¿›ç¨‹æ¥å—è¯·æ±‚</h4></li><li>accept() ä»ç¼“å­˜ä¸­æ‹¿å‡ºè¿æ¥æè¿°ç¬¦ æ­¤å¤„ä¸º é˜»å¡IO åŠ å…¥å­è¿›ç¨‹</li><li>åˆ›å»ºå­è¿›ç¨‹ æ­¤å¤„ä¸º é˜»å¡IO åœ¨å­è¿›ç¨‹ä¸­å¤„ç†</li><li>å¼€å¯å­è¿›ç¨‹</li><li>å‰ªæ‰ä¸»è¿›ç¨‹å¯¹æè¿°ç¬¦çš„å¼•ç”¨<pre><code class="python"> # å¼€å¯å¤šè¿›ç¨‹
 def runserver(self):
     &quot;&quot;&quot;
     å¤šè¿›ç¨‹å¤„ç†è¯·æ±‚
     :return:
     &quot;&quot;&quot;
     while True:
         self.new_fd, _ = self.soc.accept()  # ä»ç¼“å­˜ä¸­è¯»å–æ–°çš„è¯·æ±‚
         fd = Process(target=self.handler)  # è½¬åˆ°å­è¿›ç¨‹ä¸­æ‰§è¡Œ
         fd.start()  # å¼€å¯è¿›ç¨‹
         self.new_fd.close()  # å»æ‰ä¸»è¿›ç¨‹å¼•ç”¨</code></pre><h4 id="5-æ¥å—æè¿°ç¬¦å‘é€çš„ä¿¡æ¯"><a href="#5-æ¥å—æè¿°ç¬¦å‘é€çš„ä¿¡æ¯" class="headerlink" title="5. æ¥å—æè¿°ç¬¦å‘é€çš„ä¿¡æ¯"></a>5. æ¥å—æè¿°ç¬¦å‘é€çš„ä¿¡æ¯</h4></li></ol><pre><code class="python">    # æ¥æ”¶è¯·æ±‚å¤´
    def handler(self):
        &quot;&quot;&quot;
        å¤„ç†å‘é€è¿‡æ¥çš„ä¿¡æ¯
        :return:
        &quot;&quot;&quot;
        print(&#39;æ–°çš„é“¾æ¥åˆ°æ¥ï¼Œ&#39;, self.new_fd)
        buf: bytes = self.new_fd.recv(1024)  # è¯»å–éƒ¨åˆ†æ•°æ®ï¼Œä¸»è¦ç”¨æ¥å¤„ç†è¯·æ±‚è¡Œå’Œè¯·æ±‚å¤´
        if buf:
            new_buf = buf.decode(&#39;utf8&#39;)  # å°†äºŒè¿›åˆ¶æ•°æ®è½¬æˆstr
            # è§£æå­—ç¬¦ä¸²
            self._request_handler(new_buf)</code></pre><h4 id="6-å¤„ç†è¯·æ±‚å¤´"><a href="#6-å¤„ç†è¯·æ±‚å¤´" class="headerlink" title="6. å¤„ç†è¯·æ±‚å¤´"></a>6. å¤„ç†è¯·æ±‚å¤´</h4><ol><li>å¤„ç†è¯·æ±‚è¡Œï¼Œ æ¨èä½¿ç”¨ splitlines()è¿›è¡Œåˆ†å‰²ï¼Œ split(â€˜\r\nâ€™)åœ¨è·¨å¹³å°æ—¶ä¸å¥½ç”¨</li><li>å¤„ç†è¯·æ±‚ä½“</li><li>è·å–æ–‡ä»¶è·¯å¾„</li><li>è¿›è¡Œåç»­å¤„ç†</li></ol><pre><code class="python">    # è§£æè¯·æ±‚å¤´
    def _request_handler(self, data: str):
        &quot;&quot;&quot;
        æµè§ˆå™¨è¯·æ±‚ æ ¼å¼å›ºå®š
        è¯·æ±‚è¡Œ: GET / HTTP/1.1\r\n
        è¯·æ±‚å¤´: Host: 127.0.0.1\r\n
               User-Agent: Mozilla5.0...\r\n
        è¯·æ±‚ä½“: åŸºæœ¬ä¸ºå›ºå®šä¸ºPOST çš„å†…å®¹ï¼Œ æ­¤å¤„ä¸æ¼”ç¤º
        :param data:
        :return:
        &quot;&quot;&quot;
        data = data.splitlines()  # è¿›è¡Œè¡Œåˆ†å‰²
        request_head = data.pop(0).strip()  # æ¥å—è¯·æ±‚è¡Œ
        self.request_dict[&#39;Method&#39;], self.request_dict[&#39;Path&#39;], _ = request_head.split(&#39; &#39;)  # ç”Ÿæˆè¯·æ±‚è¡Œå­—å…¸
        # éå†dataéƒ¨åˆ†,å¾—åˆ°è¯·æ±‚å¤´ä¿¡æ¯ Host: 127.0.0.1 åˆ—è¡¨ä¸­çš„æ ¼å¼
        new_data = {x[0]: x[1] for x in [i.split(&#39;:&#39;) for i in data if &#39;: &#39; in i]}
        # æ›´æ–°å­—å…¸
        self.request_dict.update(new_data)
        # è·å–è¯·æ±‚è·¯å¾„
        self.filename = self.request_dict[&#39;Path&#39;][1:]  # è·å–è¯·æ±‚çš„url
        os.chdir(self.BASE_DIR)  # æ”¹å˜æŸ¥æ‰¾æ–‡ä»¶
        self._response_handler()
</code></pre><h4 id="7-æ‹¼æ¥åŠå‘é€å“åº”å¤´"><a href="#7-æ‹¼æ¥åŠå‘é€å“åº”å¤´" class="headerlink" title="7. æ‹¼æ¥åŠå‘é€å“åº”å¤´"></a>7. æ‹¼æ¥åŠå‘é€å“åº”å¤´</h4><ol><li><p>ç­‰å¾…çŠ¶æ€ç çš„è¿”å›</p></li><li><p>æ ¹æ®ä¸åŒçŠ¶æ€å— æ‹¼æ¥ä¸åŒçš„å“åº”è¡Œ</p></li><li><p>æ‹¼æ¥å“åº”å¤´</p></li><li><p>å‘é€å“åº”å¤´</p></li><li><p>å¤„ç†å“åº”ä½“</p><pre><code class="python"># å‘é€å“åº”å¤´
 def _response_handler(self):

     &quot;&quot;&quot;
     å“åº”ä½“çš„æ ¼å¼
     å“åº”è¡Œ: HTTP/1.1 200 OK\r\n
     å“åº”å¤´: Content-Type:text/html; charset=utf-8\r\n
            Server: My_server\r\n
     å“åº”ä½“: HTML/JSON/JPG/PNG/MP3.....
     &quot;&quot;&quot;
     self.status = self._check_request()
     response_head = f&quot;HTTP/1.1 {self.status} {self.RESPONSE_STATUS[self.status]}\r\n&quot;  # ç»„æˆè¯·æ±‚è¡Œ
     response_content = &#39;&#39;.join([i[0] + &#39;: &#39; + i[1] + &#39;\r\n&#39; for i in self.response_dict])  # ç»„æˆè¯·æ±‚å¤´
     response_end = &#39;\r\n&#39;  # æ¢è¡Œ  å¤´éƒ¨ç»“æŸ
     self.response = response_head + response_content + response_end
     # å‘é€è¯·æ±‚å¤´ä¿¡æ¯
     self.new_fd.send(self.response.encode(&#39;utf8&#39;))
     self.send_response()</code></pre><h4 id="8-åˆ¤æ–­çŠ¶æ€ç ï¼Œç®€å•åˆ¤æ–­ï¼Œæœ‰èµ„æºè¿”å›200ï¼Œæ²¡æœ‰èµ„æºè¿”å›404"><a href="#8-åˆ¤æ–­çŠ¶æ€ç ï¼Œç®€å•åˆ¤æ–­ï¼Œæœ‰èµ„æºè¿”å›200ï¼Œæ²¡æœ‰èµ„æºè¿”å›404" class="headerlink" title="8. åˆ¤æ–­çŠ¶æ€ç ï¼Œç®€å•åˆ¤æ–­ï¼Œæœ‰èµ„æºè¿”å›200ï¼Œæ²¡æœ‰èµ„æºè¿”å›404"></a>8. åˆ¤æ–­çŠ¶æ€ç ï¼Œç®€å•åˆ¤æ–­ï¼Œæœ‰èµ„æºè¿”å›200ï¼Œæ²¡æœ‰èµ„æºè¿”å›404</h4></li><li><p>åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶</p><pre><code class="python"> @set_status
 def _check_request(self):
     &quot;&quot;&quot;
     ç»™å‡ºè¿”å›å€¼ï¼Œ 403ç”¨è£…é¥°å™¨è£…é¥°
     :return:
     &quot;&quot;&quot;
     if os.path.isfile(self.filename):
         return 200
     else:
         return 404</code></pre><h4 id="9-è£…é¥°å™¨æ·»åŠ User-AgentéªŒè¯"><a href="#9-è£…é¥°å™¨æ·»åŠ User-AgentéªŒè¯" class="headerlink" title="9. è£…é¥°å™¨æ·»åŠ User-AgentéªŒè¯"></a>9. è£…é¥°å™¨æ·»åŠ User-AgentéªŒè¯</h4></li><li><p>åœ¨ç±»å¤–é¢å®šä¹‰è£…é¥°å™¨å‡½æ•°ï¼Œ</p></li><li><p>è¿›è¡ŒUser-Agentåˆ¤æ–­</p><pre><code class="python">def set_status(fun):
 &quot;&quot;&quot;
 è¿”å›å€¼çš„è£…é¥°å™¨, å¢åŠ User-Agentåˆ¤æ–­ä»£ç†æ˜¯å¦å¼‚å¸¸ï¼Œ è¿”å›403
 :param fun:
 :return:
 &quot;&quot;&quot;

 def change(self, *args, **kwargs):
     if len(self.request_dict[&#39;User-Agent&#39;]) &lt; 60:
         return 403
     else:
         return fun(self, *args, **kwargs)

 return change</code></pre><h4 id="10-å‘é€å“åº”ä½“ï¼Œå…³é—­è¿æ¥"><a href="#10-å‘é€å“åº”ä½“ï¼Œå…³é—­è¿æ¥" class="headerlink" title="10. å‘é€å“åº”ä½“ï¼Œå…³é—­è¿æ¥"></a>10. å‘é€å“åº”ä½“ï¼Œå…³é—­è¿æ¥</h4></li></ol><ul><li>æ ¹æ®ä¸åŒçš„è¿”å›å€¼ï¼Œå†³å®šå¦‚ä½•è¿”å›<pre><code class="python">  # å‘é€å“åº”ä½“å†…å®¹
  def send_response(self):
      if self.status == 200:
          # æ­£å¸¸è®¿é—®é¡µé¢
          with open(self.filename, &#39;rb&#39;) as f:
              self.new_fd.send(f.read())
      elif self.status == 404:
          # æ‰“å¼€404é¡µé¢
          with open(&#39;404.html&#39;, &#39;rb&#39;) as f:
              self.new_fd.send(f.read())
      elif self.status == 403:
          self.new_fd.send(&#39;ForForForbid&#39;.encode(&#39;utf8&#39;))  # çš®ä¸€ä¸‹</code></pre>githubä¸Šçš„å®Œæ•´ä»£ç  <a href="https://github.com/Dustyposa/segementfault/blob/master/web_server.py" target="_blank" rel="noopener">web_server</a></li></ul><p><b>æœ¬æ–‡åœ°å€ï¼š <a href="https://dustyposa.github.com/posts/6e9446e6/">https://dustyposa.github.com/posts/6e9446e6/</a></b></p></div><hr><div><p><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/%E7%BD%91%E7%BB%9C/">ç½‘ç»œ</a> &nbsp; <a class="hover-with-bg" href="/categories/%E7%BD%91%E7%BB%9C/%E6%9C%8D%E5%8A%A1%E5%99%A8/">æœåŠ¡å™¨</a> &nbsp; </span>&nbsp;&nbsp; <span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/python3/">python3</a> <a class="hover-with-bg" href="/tags/server/">server</a> <a class="hover-with-bg" href="/tags/socket/">socket</a></span></p><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0åè®®</a> ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext row"><div class="post-prev col-6"><a href="/posts/841d9ffa/"><i class="fa fa-chevron-left"></i> <span class="hidden-mobile">python è¯·æ±‚åˆ†æåŠå¤šæå–å™¨ æå–æ•°æ®</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></div><div class="post-next col-6"></div></div></div><div class="comments" id="comments"><script defer src="https://utteranc.es/client.js" repo="Dustyposa/utterances_comments" issue-term="pathname" label="âœ¨ğŸ’¬âœ¨" theme="github-light" crossorigin="anonymous"></script></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc-start"></div><div id="toc"><p class="h5"><i class="far fa-list-alt"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div></main><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div id="aplayer"></div><script defer src="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.css"><script type="text/javascript">var oldLoad=window.onload;window.onload=function(){new APlayer({container:document.getElementById("aplayer"),fixed:!0,autoplay:!1,loop:"all",order:"random",theme:"#b7daff",preload:"none",audio:[{name:"æ®‹é…·ãªå¤©ä½¿ã®ãƒ†ãƒ¼ã‚¼",artist:"é«˜æ©‹æ´‹å­",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_5130573&response=res&type=convert_url&",cover:"http://p1.music.126.net/45hISoQHiPTbPg9oapc7DQ==/109951163549396167.jpg?param=300x300"},{name:"Lemon",artist:"ç±³æ´¥ç„å¸«",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_51573181&response=res&type=convert_url&",cover:"http://p2.music.126.net/6IeZ9MiSSDXifj74nzH6ww==/109951163561494000.jpg?param=300x300"},{name:"ä¼šã„ãŸã„ã‚ˆ",artist:"æ‰‹å¡šç¿”å¤ª",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_72890829&response=res&type=convert_url&",cover:"http://p2.music.126.net/4e3vc5Ln8LDAaFhDIQ3edA==/109951164200567437.jpg?param=300x300"},{name:"Letter Song",artist:"ãƒ²ã‚¿ã¿ã‚“",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_27876755&response=res&type=convert_url&",cover:"http://p1.music.126.net/zJae2lg6igf-mBb5vbecew==/3099523278777600.jpg?param=300x300"},{name:"åƒ•ãŒæ­»ã®ã†ã¨æ€ã£ãŸã®ã¯",artist:"ä¸­å³¶ç¾å˜‰",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_7006766&response=res&type=convert_url&",cover:"http://p1.music.126.net/HE-K4mxyNGF84xlyuxx9Wg==/109951163825342747.jpg?param=300x300"},{name:"å…‰ã‚‹ãªã‚‰",artist:"Goose house",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_6400506&response=res&type=convert_url&",cover:"http://p2.music.126.net/TM6SM2-ppcd1F66YyjR-Eg==/2537672838610591.jpg?param=300x300"}]}),oldLoad&&oldLoad()}</script><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><b>Fluid</b></a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script><script>$(document).ready(function(){var s=$("#navbar").height(),c=$("#toc"),t=$("#board-ctn"),o=t.offset().top,i=2*o+t.height();$(window).scroll(function(){var t=$("#toc-start").offset().top-s,o=document.body.scrollTop+document.documentElement.scrollTop;t<=o&&o<=i?c.css({display:"block",position:"fixed",top:s}):o<=t?c.css({position:"",top:""}):i<o&&c.css("display","none")}),tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,headingsOffset:-o}),0<$(".toc-list-item").length&&$("#toc > p").css("visibility","visible");var l=t.css("margin-right");$("#toc-ctn").css({right:l})})</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-163481315-1","auto"),ga("send","pageview")</script><script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script><script>$(document).ready(function(){$("pre").addClass("prettyprint  "),prettyPrint()})</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","python ç¼–å†™å¤šè¿›ç¨‹ socket webé™æ€æœåŠ¡å™¨&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "â¡"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#post img:not(.no-zoom img, img[no-zoom])").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><script>!function(e,r,t){var o,n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(t){var a=r.createElement("style");a.type="text/css";try{a.appendChild(r.createTextNode(t))}catch(e){a.styleSheet.cssText=t}r.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o="function"==typeof e.onclick&&e.onclick,e.onclick=function(e){var t,a;o&&o(),t=e,(a=r.createElement("div")).className="heart",n.push({el:a,x:t.clientX-5,y:t.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),r.body.appendChild(a)},function e(){for(var t=0;t<n.length;t++)n[t].alpha<=0?(r.body.removeChild(n[t].el),n.splice(t,1)):(n[t].y--,n[t].scale+=.004,n[t].alpha-=.013,n[t].el.style.cssText="left:"+n[t].x+"px;top:"+n[t].y+"px;opacity:"+n[t].alpha+";transform:scale("+n[t].scale+","+n[t].scale+") rotate(45deg);background:"+n[t].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/ni-j.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>