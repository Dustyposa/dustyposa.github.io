<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="ä¸€äº›ç»éªŒçš„è®°å½•ã€‚"><meta name="author" content="Dusty Posa"><meta name="keywords" content="python,python3,process,script"><title>åŸºäº rasa çš„è¯­éŸ³åŠ©æ‰‹æ­å»º - Posaã®ã«ã‚</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"><link rel="stylesheet" href="/css/main.css"><link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Posaã®ã«ã‚</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/">å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/">åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/">æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="/about/">å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(https://i.loli.net/2020/04/14/smYH5uD8Pb7k4oI.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask rgba-black-light flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><p class="mt-3 post-meta"><i class="fas fa-calendar-alt" aria-hidden="true"></i> æ˜ŸæœŸä¸‰, ä¸€æœˆ 13æ—¥ 2021, 12:03 ä¸­åˆ</p><p class="mt-1"><span class="post-meta"><i class="far fa-chart-bar"></i> 3k å­— </span><span class="post-meta"><i class="far fa-clock"></i> 13 åˆ†é’Ÿ</span></p></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><p class="note note-warning">æœ¬æ–‡æœ€åæ›´æ–°äºï¼šæ˜ŸæœŸå››, ä¸€æœˆ 14æ—¥ 2021, 3:15 å‡Œæ™¨</p><div class="markdown-body"><h2 id="ä¸ºä»€ä¹ˆå†™æœ¬æ–‡ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå†™æœ¬æ–‡ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå†™æœ¬æ–‡ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå†™æœ¬æ–‡ï¼Ÿ</h2><p>åœ¨å·¥ä¸šçº§çš„å¼€æºå¯¹è¯ç³»ç»Ÿç³»ç»Ÿä¸­ï¼Œ<a href="https://rasa.com/" target="_blank" rel="noopener">RASA</a> æ˜¯ä¸äºŒä¹‹é€‰ã€‚<br>åŸºäº <code>RASA</code> çš„ç®€å•çš„å¯¹è¯ç³»ç»Ÿæ–‡ç« æœ‰å¾ˆå¤šï¼Œæœ¬æ–‡å°±ä¸åœ¨èµ˜è¿°ã€‚ä½†æ˜¯åŸºäº <code>RASA</code> è¯­éŸ³å¯¹è¯çš„æ–‡ç« å¾ˆå°‘ã€‚<br>æ‰€ä»¥ï¼Œæœ¬æ–‡ä¸»è¦æ˜¯æ­å»ºä¸€ä¸ªåŸºäº <code>RASA çš„è¯­éŸ³</code> å¯¹è¯ç³»ç»Ÿã€‚<br>åŸºæœ¬èµ„æ–™å‚è€ƒäº <a href="https://blog.rasa.com/how-to-build-a-voice-assistant-with-open-source-rasa-and-mozilla-tools/" target="_blank" rel="noopener"><code>è¿™ç¯‡æ–‡ç« </code></a>ã€‚<br>ç®€å•çš„è¯´å°±æ˜¯è¸©å‘é¿é™©è®°ã€‚</p><h2 id="ä½ èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ"><a href="#ä½ èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä½ èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ"></a>ä½ èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ</h2><ul><li><ol><li><code>RASA</code> çš„ä¸€äº›ç›¸å…³çŸ¥è¯†</li></ol></li><li><ol start="2"><li>å¦‚ä½•åœ¨ <code>RASA</code> ä¸­è‡ªå®šä¹‰ <code>channel</code></li></ol></li><li><ol start="3"><li>å¦‚ä½•ä½¿ç”¨ <code>deepspeech</code> å®ç° <code>STT(è¯­éŸ³è½¬æ–‡å­—)</code></li></ol></li><li><ol start="4"><li>å¦‚ä½•ä½¿ç”¨ <code>TTS(æ–‡å­—è½¬è¯­éŸ³)</code></li></ol></li></ul><h2 id="æœ€ç»ˆå‘ˆç°æ˜¯ä»€ä¹ˆ"><a href="#æœ€ç»ˆå‘ˆç°æ˜¯ä»€ä¹ˆ" class="headerlink" title="æœ€ç»ˆå‘ˆç°æ˜¯ä»€ä¹ˆ?"></a>æœ€ç»ˆå‘ˆç°æ˜¯ä»€ä¹ˆ?</h2><p>çœ‹çœ‹è¿™é‡Œ:</p><blockquote><iframe src="//player.bilibili.com/player.html?bvid=BV1si4y1c7tF&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen width="650" height="366"></iframe></blockquote><h2 id="ä¸€äº›åŸºç¡€ä»‹ç»"><a href="#ä¸€äº›åŸºç¡€ä»‹ç»" class="headerlink" title="ä¸€äº›åŸºç¡€ä»‹ç»"></a>ä¸€äº›åŸºç¡€ä»‹ç»</h2><h4 id="å®ç°è¯­éŸ³åŠ©æ‰‹éœ€è¦ä»€ä¹ˆ"><a href="#å®ç°è¯­éŸ³åŠ©æ‰‹éœ€è¦ä»€ä¹ˆ" class="headerlink" title="å®ç°è¯­éŸ³åŠ©æ‰‹éœ€è¦ä»€ä¹ˆ"></a>å®ç°è¯­éŸ³åŠ©æ‰‹éœ€è¦ä»€ä¹ˆ</h4><div class="mermaid">graph LR; è¯­éŸ³è¾“å…¥-- STT -->æ–‡å­—è¾“å…¥; æ–‡å­—è¾“å…¥-- text -->å¯¹è¯æ¨¡å—; å¯¹è¯æ¨¡å—-- text -->æ–‡å­—è¾“å‡º; æ–‡å­—è¾“å‡º-- TTS -->è¯­éŸ³è¾“å‡º;</div><p>å†æ¥ä¸ªå…·è±¡ä¸€ç‚¹çš„å›¾</p><blockquote><p><img src="https://i.loli.net/2021/01/13/TLjEoIgh3MYx7G2.png" srcset="/img/loading.gif" alt=""></p></blockquote><p>ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬æ ¸å¿ƒè¦è§£å†³çš„å³æ˜¯ <code>SSTã€å¯¹è¯æ¨¡å—ä»¥åŠTTS</code><br><strong>å¯¹è¯æ¨¡å—</strong>ï¼Œæˆ‘ä»¬æœ‰äº† <code>rasa</code> æ¥ä½œä¸ºå®ç°ã€‚<br>å…¶ä½™ä¸¤ä¸ªæˆ‘ä»¬é€‰æ‹©å¼€æºå·¥å…·æ¥å®ç°ã€‚</p><ul><li><code>STT</code><ul><li><a href="https://github.com/mozilla/DeepSpeech" target="_blank" rel="noopener">DeepSpeech</a></li></ul></li><li><code>TTS</code><ul><li><a href="https://github.com/mozilla/TTS" target="_blank" rel="noopener">TTS</a></li></ul></li></ul><p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹å¤Ÿäº†å—? å½“ç„¶ä¸å¤Ÿï¼<br><strong>è¯­éŸ³</strong>ä»å“ªé‡Œæ¥?åˆ°å“ªé‡Œå»?<br>æ²¡é”™ï¼Œæˆ‘ä»¬è¿˜å°‘ä¸€ä¸ª <code>UI</code>ï¼Œä½œä¸ºä¸ç”¨æˆ·äº¤äº’çš„æ¥å£ã€‚<br>è¿™é‡Œæˆ‘ä»¬é€‰ç”¨: <a href="https://github.com/RasaHQ/rasa-voice-interface" target="_blank" rel="noopener">rasa-voice-interface</a><br>æœ‰äº†è¿™4ä¸ªç¥å™¨ï¼ŒåŸºç¡€ç‰ˆæœ¬çš„éœ€æ±‚æˆ‘ä»¬åº”è¯¥èƒ½æ»¡è¶³äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„æ¶æ„:</p><blockquote><p><img src="https://i.loli.net/2021/01/13/iHSXyRpKDgvC3cm.png" srcset="/img/loading.gif" alt=""><br>æ³¨æ„:<br>å³è¾¹ <code>rasa</code> çš„å›¾ä¸º <code>1.x</code> ç‰ˆæœ¬çš„ç»“æ„ï¼Œ <code>2.x</code> åº”è¯¥ä¸º <code>NLUï¼ˆè‡ªç„¶è¯­è¨€ç†è§£ï¼‰</code> å’Œ <code>DMï¼ˆå¯¹è¯ç®¡ç†ï¼‰</code><br>åˆèµ·æ¥å°±èƒ½å®ç°æ•´ä¸ªå¯¹è¯ã€‚</p></blockquote><p>å¥½äº†ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„å…¨éƒ¨å†…å®¹ï¼Œçœ‹èµ·æ¥ä¹Ÿä¸å¤ªå¤æ‚å¯¹å§ã€‚ï¼ˆå—¯ï¼çš„ç¡®ä¸å¤ª<em>å¤æ‚</em>ã€‚ï¼‰</p><h2 id="æˆ‘ä»¬åº”è¯¥æ€è€ƒä¸€äº›ä»€ä¹ˆ"><a href="#æˆ‘ä»¬åº”è¯¥æ€è€ƒä¸€äº›ä»€ä¹ˆ" class="headerlink" title="æˆ‘ä»¬åº”è¯¥æ€è€ƒä¸€äº›ä»€ä¹ˆ"></a>æˆ‘ä»¬åº”è¯¥æ€è€ƒä¸€äº›ä»€ä¹ˆ</h2><h4 id="å„éƒ¨åˆ†å¦‚ä½•è¿æ¥"><a href="#å„éƒ¨åˆ†å¦‚ä½•è¿æ¥" class="headerlink" title="å„éƒ¨åˆ†å¦‚ä½•è¿æ¥?"></a>å„éƒ¨åˆ†å¦‚ä½•è¿æ¥?</h4><p>æ‹†æˆ <code>4</code> éƒ¨åˆ†åï¼Œå…¶å®æˆ‘ä»¬çš„æ¯ä¸€éƒ¨åˆ†éƒ½å¯ä»¥æ›¿æ¢ï¼Œ<br>æ¯”å¦‚:</p><ul><li><code>STT</code> æ›¿æ¢ä¸ºæ¥å£è¯·æ±‚æœåŠ¡ï¼ˆ<code>CRUD</code> å¤§æ³•å¥½ï¼‰</li><li><code>TTS</code> æ›¿æ¢ä¸ºå€Ÿå£è¯·æ±‚æœåŠ¡ï¼ˆ<code>CRUD</code> å¤§æ³•å¥½å¾—ä¸å¾—äº†ï¼‰</li><li><code>RASA</code> æ›¿æ¢ä¸º <code>Google Dialogflowã€Wit.aiã€Microsoft LUISã€IBM Watson</code> ç­‰</li></ul><p>ä½†æ˜¯ <code>UI</code> çš„æ›¿æ¢ç¨å¾®éº»çƒ¦ä¸€äº›ï¼Œé‚£æˆ‘ä»¬å°±å‡å®š <code>UI</code> çš„é€»è¾‘æ˜¯ä¸å˜çš„ï¼Œçœ‹çœ‹æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠã€‚<br>æˆ‘ä»¬å…ˆæƒ³ä¸€ä¸‹å„éƒ¨åˆ†çš„è¾“å…¥è¾“å‡º:</p><ul><li><p><code>UI</code>:</p><div class="mermaid">graph LR; è¾“å…¥ --- id1>è¯­éŸ³]; è¾“å‡º --- id1;</div><p>éƒ½æ˜¯<code>è¯­éŸ³</code>çš„è¾“å…¥è¾“å‡ºï¼Œé‚£ä¹ˆè¦ä¹ˆæ˜¯æ–‡ä»¶ä¼ è¾“ï¼Œè¦ä¹ˆæ˜¯æºæ•°æ®ä¼ è¾“ã€‚<br>ä» <code>UI</code> çš„<a href="https://github.com/RasaHQ/rasa-voice-interface" target="_blank" rel="noopener">æºç </a>ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç”¨æˆ·<strong>è¾“å…¥</strong>è¯­éŸ³åï¼Œé€šè¿‡ <code>socket</code> ä¼ è¾“ <code>base64</code> ç¼–ç çš„è¯­éŸ³æ•°æ®ï¼Œä¼ ç»™ <code>5005</code> ç«¯å£ã€‚<strong>è¾“å‡º</strong>è¯­éŸ³é€šè¿‡ä¸€ä¸ªè¿æ¥ä¸‹è½½è¯­éŸ³ï¼Œç„¶åæ’­æ”¾ã€‚</p></li><li><p><code>STT</code>:</p><div class="mermaid">graph LR; è¾“å…¥ --- id1>è¯­éŸ³]; è¾“å‡º --- id2>æ–‡æœ¬];</div></li><li><p><code>TTS</code>:</p><div class="mermaid">graph LR; è¾“å…¥ --- id1>æ–‡æœ¬]; è¾“å‡º --- id2>è¯­éŸ³];</div></li><li><p><code>RASA</code>:</p><div class="mermaid">graph LR; è¾“å…¥ --- id1>æ–‡æœ¬]; è¾“å‡º --- id1;</div><p>é€šè¿‡ä»¥ä¸Šçš„è¾“å…¥è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä¸»è¦éœ€è¦å®ç°ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå®ç°å„éƒ¨åˆ†æ•°æ®çš„æµè½¬ã€‚<br>è¿™ä¸ªä¸­é—´ä»¶çš„åŠŸèƒ½ä¸»è¦æ˜¯:<br>å®ç° <code>æ–‡æœ¬è¯­éŸ³</code> çš„äº’è½¬ï¼Œå¹¶æ§åˆ¶ <code>æ–‡æœ¬</code> æ•°æ®åœ¨ <code>RASA</code> ä¸­æµè½¬ã€‚<br>å°±åƒè¿™æ ·:</p><div class="mermaid">graph LR; è¯­éŸ³-- middleware --> rasa; rasa -- middleware --> è¯­éŸ³;</div></li></ul><p>äºæ˜¯ï¼Œæˆ‘ä»¬é€‰æ‹©çš„ç›®æ ‡å˜æˆäº†åˆ¶ä½œä¸€ä¸ªæ§åˆ¶ <em>è¯­éŸ³æ–‡æœ¬</em> è½¬æ¢çš„ <code>middleware</code> ã€‚</p><h4 id="åˆ¶ä½œ-middleware"><a href="#åˆ¶ä½œ-middleware" class="headerlink" title="åˆ¶ä½œ middleware"></a>åˆ¶ä½œ <code>middleware</code></h4><p>æ€ä¹ˆåš?æ€ä¹ˆç»“åˆ?è¯´é‚£ä¹ˆå¹²å˜›ï¼Œç›´æ¥åšå‘€ã€‚<br>åˆ«æ€¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ <code>RASA</code> çš„æ–‡æ¡£ã€‚</p><blockquote><p>â€¦â€¦ ç»è¿‡çŸ­æš‚çš„æ–‡æ¡£æŸ¥é˜…</p></blockquote><p>å¥½å®¶ä¼™ï¼Œæœåˆ° <a href="https://rasa.com/docs/rasa/connectors/telegram" target="_blank" rel="noopener">voice</a> äº†ã€‚<br>çœ‹çœ‹æºç ï¼ˆæºç é˜…è¯»ä¸­â€¦åŸæ¥å¦‚æ­¤åŸæ¥å¦‚æ­¤â€¦, <code>OutputChannel</code> è·å¾—ï¼Œ <code>InputChanel</code> è·å¾—)ã€‚<br>ä»æºç ä¸­ï¼Œæˆ‘ä»¬å‘ç°è™½ç„¶åªæœ‰ <code>å‘é€ audio</code> çš„åŠŸèƒ½æ˜¯æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯è‡³å°‘æˆ‘ä»¬çŸ¥é“äº† <code>Rasa</code> ä¸­æœ‰ä¸€ä¸ª <a href="https://rasa.com/docs/rasa/connectors/your-own-website#websocket-channel" target="_blank" rel="noopener"><code>Channel Conncetor</code></a> çš„ä¸œè¥¿ï¼Œèƒ½å¸®æˆ‘ä»¬è¿›è¡Œè¾“å…¥è¾“å‡ºçš„è°ƒæ•´ï¼Œè¿æ¥åˆ°ä¸åŒçš„åœ°æ–¹ï¼ˆç›¸å½“äºåŒ¹é…ä¸åŒçš„ <code>UI</code>ï¼Œ ä¾‹å¦‚: <code>Slackã€Facebook ...</code>ï¼‰ã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬æ–°çš„ç›®æ ‡ï¼Œæœ‰äº†ï¼<br><strong>åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„ <code>Channel</code>ã€‚</strong></p><h2 id="å¼€å§‹åˆ¶ä½œ-Channel"><a href="#å¼€å§‹åˆ¶ä½œ-Channel" class="headerlink" title="å¼€å§‹åˆ¶ä½œ Channel"></a>å¼€å§‹åˆ¶ä½œ <code>Channel</code></h2><h4 id="é€‰æ‹©åŸºç¡€-Channel"><a href="#é€‰æ‹©åŸºç¡€-Channel" class="headerlink" title="é€‰æ‹©åŸºç¡€ Channel"></a>é€‰æ‹©åŸºç¡€ <code>Channel</code></h4><p>ç›®å‰æœ‰ä¸¤ç§ <code>Channel</code> å¯ä»¥é€‰æ‹©ï¼Œ <code>Rest Channel</code> ä»¥åŠ <code>WebSocket Channel</code><br>è¿™é‡Œæˆ‘ä»¬é€‰æ‹© <code>WebSocket Channel</code> (å› ä¸º <code>UI</code> çš„æ¥å£æ˜¯ <code>WebSocket</code>)</p><h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><p>ç¼–å†™ <code>voice_connector.py</code> ã€‚<br>ç­‰ç­‰ï¼Œå¤ªå¿«äº†ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æ•´ä½“ç»“æ„ï¼Œæ•´ç†ä¸€ä¸‹ã€‚æ ¹æ® <code>Channel</code> çš„ç¤ºä¾‹ã€‚<br>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªç±» <code>VoiceInput, VoiceOutput</code>, åˆ†åˆ«å¯¹åº” <code>Channel</code> çš„ <code>è¾“å…¥å’Œè¾“å‡º</code>ã€‚</p><p><code>VoiceInput</code> ä¸­éœ€è¦å®ç°:</p><ul><li>æ¥æ”¶è¯­éŸ³æ•°æ®</li><li><code>STT</code></li></ul><p><code>VoiceOutput</code> ä¸­éœ€è¦å®ç°:</p><ul><li><code>TTS</code></li><li>å‘é€è¯­éŸ³æ•°æ®</li></ul><h4 id="å¼€å§‹-VoiceInput"><a href="#å¼€å§‹-VoiceInput" class="headerlink" title="å¼€å§‹ VoiceInput"></a>å¼€å§‹ <code>VoiceInput</code></h4><p>æˆ‘ä»¬ç»§æ‰¿ç°æœ‰çš„ <code>SocketIOInput</code>ï¼Œé‡å†™ä¸»è¦çš„éƒ¨åˆ†ï¼Œ<code>blueprint</code> æ–¹æ³•ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="python">class VoiceInput(SocketIOInput):
    def blueprint(
            self, on_new_message: Callable[[UserMessage], Awaitable[Any]]
    ) -&gt; Blueprint:
        # Workaround so that socketio works with requests from other origins.
        # https://github.com/miguelgrinberg/python-socketio/issues/205#issuecomment-493769183
        sio = AsyncServer(async_mode=&quot;sanic&quot;, cors_allowed_origins=&quot;*&quot;)
        socketio_webhook = SocketBlueprint(
            sio, self.socketio_path, &quot;socketio_webhook&quot;, __name__
        )

        self.sio = sio
        --- skip -- 
        @sio.on(self.user_message_evt, namespace=self.namespace)
        async def handle_message(sid: Text, data: Dict) -&gt; Any:
            &quot;&quot;&quot;å¤„ç†æ”¶åˆ°çš„å®¢æˆ·ç«¯æ•°æ®&quot;&quot;&quot;
            output_channel = VoiceOutput(sio, self.bot_message_evt)  # åˆå§‹åŒ– Output

            message = data[&quot;message&quot;]
            if message == &quot;/get_started&quot;:
                message = data[&quot;message&quot;]
            else:
                &quot;å¤„ç†å‘é€è¿‡æ¥çš„è¯­éŸ³æ•°æ®&quot;
                bytes_data = base64.b64decode(message.split(&quot;,&quot;, maxsplit=1)[-1])  #  è§£ç  base64 è·å–è¯­éŸ³å…ƒæ•°æ®
                audio, fs = librosa.load(
                    BytesIO(bytes_data), sr=None, dtype=&quot;int16&quot;, mono=False
                )  # è·å–å£°æ³¢æ•°æ®
                print(&quot;è·å–éŸ³é¢‘ä¿¡æ¯æˆåŠŸ&quot;)
                message = ds.predict_to_string(audio, fs)  # STT
                print(f&quot;é¢„æµ‹è¾“å‡ºä¸º: {message}&quot;)
                await sio.emit(
                    self.user_message_evt, {&quot;text&quot;: message}, room=sid
                )  # æ–‡æœ¬å‘ç»™å‰ç«¯ï¼Œç”¨ä½œæ˜¾ç¤º

            message = UserMessage(
                message, output_channel, sid, input_channel=self.name()
            )
            await on_new_message(message)

        return socketio_webhook
</code></pre><p>ä»£ç ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ¨¡æ¿å…¶å®æ²¡æœ‰å˜åŒ–ï¼Œä¸»è¦æ˜¯ æ•°æ®çš„å¤„ç†é€»è¾‘å‘ç”Ÿæ”¹å˜ã€‚<br>éœ€è¦æ³¨æ„çš„ç‚¹:</p><ul><li><code>self.user_message_evt</code> è¿™ä¸ª <code>event</code> ä¼šæ‰§è¡Œ <code>handle_message</code> æ–¹æ³•ã€‚<code>self.user_message_evt</code> ç›®å‰ä½¿ç”¨çš„é»˜è®¤å€¼ã€‚</li><li>æ‰§è¡Œ <code>await on_new_message(message)</code> çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œ <code>RASA</code> çš„ <code>NLU</code> ä»¥åŠ <code>DM</code> æœ€ç»ˆè·å¾— ä¸€ä¸ªè¾“å‡ºçš„ <code>message</code>, è¿™ä¸ª <code>message</code> çš„æ ¼å¼å¯ä»¥è‡ªå®šä¹‰çš„ã€‚</li><li><code>sio = AsyncServer(async_mode=&quot;sanic&quot;, cors_allowed_origins=&quot;*&quot;)</code>ï¼Œè¿™é‡Œ <code>cors_allowed_origins</code> è¿™æ ·æ–¹ä¾¿ä¸€äº›ï¼Œå¦åˆ™è·¨åŸŸã€‚</li></ul><h4 id="å¼€å§‹-VoiceOutput"><a href="#å¼€å§‹-VoiceOutput" class="headerlink" title="å¼€å§‹ VoiceOutput"></a>å¼€å§‹ <code>VoiceOutput</code></h4><p>åŒæ ·ï¼Œæˆ‘ä»¬ç»§æ‰¿ç°æœ‰çš„ <code>SocketIOOutput</code>ï¼Œé‡å†™ä¸»è¦çš„éƒ¨åˆ†ï¼Œ<code>send_text_message</code> æ–¹æ³•ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="python">class VoiceOutput(SocketIOOutput):
    async def send_text_message(
            self, recipient_id: Text, text: Text, **kwargs: Any
    ) -&gt; None:
        &quot;&quot;&quot;Send a message through this channel.&quot;&quot;&quot;
        print(&quot;å¼€å§‹å‘é€ä¿¡æ¯&quot;)
        await self._send_audio_message(socket_id=recipient_id, response={&quot;text&quot;: text})

    async def _send_audio_message(self, socket_id: str, response: Any) -&gt; None:
        &quot;&quot;&quot;Sends a message to the recipient using the bot event.&quot;&quot;&quot;

        ts = time.time()
        out_file_name = str(ts) + &quot;.wav&quot;
        link = self.FILE_SERVER + out_file_name
        tts_run(text=response[&quot;text&quot;], file_name=out_file_name)  # TTS ç”Ÿæˆè¯­éŸ³æ–‡ä»¶
        await self._send_message(
            response={&quot;text&quot;: response[&quot;text&quot;], &quot;link&quot;: link}, socket_id=socket_id
        )  # å‘é€ç»™å‰ç«¯
</code></pre><p><code>VoiceOutput</code> å°±æ›´ç®€å•äº†ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯:</p><ul><li>è¿™é‡Œæˆ‘ä»¬é‡å†™ <code>send_text_message</code> æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬çš„æœºå™¨äººè¿”å›çš„ä¸º <code>text</code> çš„æ ¼å¼</li><li><code>{&quot;text&quot;: response[&quot;text&quot;], &quot;link&quot;: link}</code> è¿™ä¸ªä¸ºå›ºå®šæ ¼å¼ï¼Œå‰ç«¯ä» <code>link</code> åœ°å€ä¸‹è½½ éŸ³é¢‘æ–‡ä»¶å¹¶æ’­æ”¾ã€‚</li><li><h2 id="SARA-æœºå™¨äººçš„å‡†å¤‡"><a href="#SARA-æœºå™¨äººçš„å‡†å¤‡" class="headerlink" title="SARA æœºå™¨äººçš„å‡†å¤‡"></a>SARA æœºå™¨äººçš„å‡†å¤‡</h2>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å®˜æ–¹çš„ <code>rasa-demo</code> æœºå™¨äººåšæ¼”ç¤ºï¼Œå…¶ä»–æœºå™¨äººåŒç†ã€‚<br><a href="https://github.com/RasaHQ/rasa-demo" target="_blank" rel="noopener">å®˜æ–¹æ•™ç¨‹</a><h4 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h4><pre><code class="bash">git clone https://github.com/RasaHQ/rasa-demo.git --depth 1
cd rasa-demo
pip install -r requirements.txt
pip install -e .</code></pre><h4 id="2-è®­ç»ƒæ¨¡å‹"><a href="#2-è®­ç»ƒæ¨¡å‹" class="headerlink" title="2. è®­ç»ƒæ¨¡å‹"></a>2. è®­ç»ƒæ¨¡å‹</h4><code>rasa train --augmentation 0 # åŠ é€Ÿè®­ç»ƒ</code></li></ul><h4 id="3-æ›´æ”¹-channel"><a href="#3-æ›´æ”¹-channel" class="headerlink" title="3. æ›´æ”¹ channel"></a>3. æ›´æ”¹ <code>channel</code></h4><p>åˆ›å»º <code>credentials.yml</code><br>å†…å®¹å¦‚ä¸‹:</p><pre><code class="yml">utils.voice_connector.VoiceInput:
  bot_message_evt: bot_uttered
  session_persistence: true
  user_message_evt: user_uttered</code></pre><p><code>utils.voice_connector.VoiceInput</code> ä¸ºæ”¾æˆ‘ä»¬ç¼–å†™çš„ <code>channel</code> çš„åœ°æ–¹ï¼Œéœ€åˆ¶å®šåˆ° <code>Input</code> çš„ <code>class</code>ã€‚<code>utils</code> ä¸ºæ–‡ä»¶å¤¹åå­—ã€‚</p><h4 id="4-è¿è¡Œï¼ˆä¸æ˜¯ç°åœ¨ï¼‰"><a href="#4-è¿è¡Œï¼ˆä¸æ˜¯ç°åœ¨ï¼‰" class="headerlink" title="4. è¿è¡Œï¼ˆä¸æ˜¯ç°åœ¨ï¼‰"></a>4. è¿è¡Œï¼ˆä¸æ˜¯ç°åœ¨ï¼‰</h4><ul><li><code>duckling</code><ul><li><code>docker run -p 8000:8000 rasa/duckling</code></li></ul></li><li><code>action server</code><ul><li><code>rasa run actions --actions actions.actions</code></li></ul></li><li><code>rasa api</code><ul><li><code>rasa run --enable-api -p 5005</code></li></ul></li></ul><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½“éªŒä¸€ä¸‹ï¼Œè¿è¡Œå‰ä¸¤ä¸ªæœåŠ¡å:<br><code>rasa shell --debug</code><br>æœ¬åœ°å¯åŠ¨ <code>rasa</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å’Œæœºå™¨äººå¯¹è¯äº†ã€‚</p><h2 id="å…¶ä½™å‰©ä½™çš„éƒ¨åˆ†"><a href="#å…¶ä½™å‰©ä½™çš„éƒ¨åˆ†" class="headerlink" title="å…¶ä½™å‰©ä½™çš„éƒ¨åˆ†"></a>å…¶ä½™å‰©ä½™çš„éƒ¨åˆ†</h2><p>å‰©ä¸‹éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œæ›¿ä»£æ€§æ¯”è¾ƒå¼ºï¼Œæˆ‘å°±ç®€å•è¿‡ä¸€ä¸‹äº†ã€‚</p><h3 id="STT"><a href="#STT" class="headerlink" title="STT"></a>STT</h3><h4 id="1-å®‰è£…åŠæ¨¡å‹ä¸‹è½½"><a href="#1-å®‰è£…åŠæ¨¡å‹ä¸‹è½½" class="headerlink" title="1. å®‰è£…åŠæ¨¡å‹ä¸‹è½½"></a>1. å®‰è£…åŠæ¨¡å‹ä¸‹è½½</h4><p><a href="https://deepspeech.readthedocs.io/en/latest/?badge=latest" target="_blank" rel="noopener">å®˜æ–¹æ•™ç¨‹</a></p><pre><code class="bash"># Install DeepSpeech
pip3 install deepspeech

# Download pre-trained English model files
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.3/deepspeech-0.9.3-models.pbmm
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.3/deepspeech-0.9.3-models.scorer</code></pre><h4 id="2-ç¼–å†™-STT-éƒ¨åˆ†"><a href="#2-ç¼–å†™-STT-éƒ¨åˆ†" class="headerlink" title="2. ç¼–å†™ STT éƒ¨åˆ†"></a>2. ç¼–å†™ <code>STT</code> éƒ¨åˆ†</h4><p><code>deepspeech.py</code> ä½¿ç”¨èµ·æ¥ç›¸å½“ç®€å•ã€‚</p><pre><code class="python">from deepspeech import Model


class DeepSpeechModel:
    def __init__(self):
        self.ds = self._load_model()

    @staticmethod
    def _load_model():
        ds = Model(&quot;deepspeech-0.9.3-models.pbmm&quot;)
        ds.enableExternalScorer(&quot;deepspeech-0.9.3-models.scorer&quot;)
        return ds

    def predict_to_string(self, audio, fs) -&gt; str:
        return self._metadata_to_string(
            self.ds.sttWithMetadata(audio, fs).transcripts[0]
        )

    @staticmethod
    def _metadata_to_string(metadata):
        return &quot;&quot;.join(token.text for token in metadata.tokens)</code></pre><p>æˆ‘ä»¬çš„ <code>ds</code> æœ‰äº†ã€‚</p><h3 id="TTS"><a href="#TTS" class="headerlink" title="TTS"></a>TTS</h3><p><a href="https://github.com/mozilla/TTS" target="_blank" rel="noopener">å®˜æ–¹æ•™ç¨‹</a></p><h4 id="1-å®‰è£…åŠæ¨¡å‹ä¸‹è½½-1"><a href="#1-å®‰è£…åŠæ¨¡å‹ä¸‹è½½-1" class="headerlink" title="1. å®‰è£…åŠæ¨¡å‹ä¸‹è½½"></a>1. å®‰è£…åŠæ¨¡å‹ä¸‹è½½</h4><p><a href="https://colab.research.google.com/drive/1tKHSI20kRlOL0PSA8mCVJQIrgRIswg0F?usp=sharing" target="_blank" rel="noopener">å‚è€ƒæ•™ç¨‹</a><br>ä½¿ç”¨åˆ°çš„æ¨¡å‹:</p><pre><code class="bash">curl -LO https://drive.google.com/uc?id=1dntzjWFg7ufWaTaFy80nRz-Tu02xWZos tts_model.pth.tar
curl -LO https://drive.google.com/uc?id=18CQ6G6tBEOfvCHlPqP8EBI4xWbrr9dBc config.json
curl -LO https://drive.google.com/uc?id=1Ty5DZdOc0F7OTGj9oJThYbL5iVu_2G0K vocoder_model.pth.tar
curl -LO https://drive.google.com/uc?id=1Rd0R_nRCrbjEdpOwq6XwZAktvugiBvmu config_vocoder.json
curl -LO https://drive.google.com/uc?id=11oY3Tv0kQtxK_JPgxrfesa99maVXHNxU scale_stats.npy</code></pre><p>å®‰è£… <code>tts</code>:</p><pre><code class="bash">sudo apt-get install espeak
git clone https://github.com/mozilla/TTS.git
git checkout b1935c97
pip install -r requirements.txt
python setup.py install</code></pre><h4 id="2-ç¼–å†™ä»£ç "><a href="#2-ç¼–å†™ä»£ç " class="headerlink" title="2. ç¼–å†™ä»£ç "></a>2. ç¼–å†™ä»£ç </h4><p><code>tts.py</code>:</p><pre><code class="python">import time
from functools import partial

import torch
import wavio
from TTS.utils.audio import AudioProcessor
from TTS.utils.generic_utils import setup_model
from TTS.utils.io import load_config
from TTS.utils.synthesis import synthesis
from TTS.utils.text.symbols import phonemes, symbols
from TTS.vocoder.utils.generic_utils import setup_generator

# runtime settings
use_cuda = False

# model paths
BASE_DIR = &quot;./&quot;
TTS_MODEL = BASE_DIR + &quot;tts_model.pth.tar&quot;
TTS_CONFIG = BASE_DIR + &quot;config.json&quot;
VOCODER_MODEL = BASE_DIR + &quot;vocoder_model.pth.tar&quot;
VOCODER_CONFIG = BASE_DIR + &quot;config_vocoder.json&quot;

# è¯»å–é…ç½®æ–‡ä»¶
TTS_CONFIG = load_config(TTS_CONFIG)
VOCODER_CONFIG = load_config(VOCODER_CONFIG)

# åŠ è½½ audio processor
ap = AudioProcessor(**TTS_CONFIG.audio)
# åŠ è½½ TTS MODEL
# multi speaker
speaker_id = None
speakers = []

# load the model
num_chars = len(phonemes) if TTS_CONFIG.use_phonemes else len(symbols)
model = setup_model(num_chars, len(speakers), TTS_CONFIG)

# load model state
cp = torch.load(TTS_MODEL, map_location=torch.device(&quot;cpu&quot;))

# load the model
model.load_state_dict(cp[&quot;model&quot;])
if use_cuda:
    model.cuda()
model.eval()

# set model stepsize
if &quot;r&quot; in cp:
    model.decoder.set_r(cp[&quot;r&quot;])

# LOAD VOCODER MODEL
vocoder_model = setup_generator(VOCODER_CONFIG)
vocoder_model.load_state_dict(torch.load(VOCODER_MODEL, map_location=&quot;cpu&quot;)[&quot;model&quot;])
vocoder_model.remove_weight_norm()
vocoder_model.inference_padding = 0

ap_vocoder = AudioProcessor(**VOCODER_CONFIG[&quot;audio&quot;])
if use_cuda:
    vocoder_model.cuda()
vocoder_model.eval()


def tts(model, text, file_name, CONFIG, use_cuda, ap, use_gl):
    t_1 = time.time()
    waveform, alignment, mel_spec, mel_postnet_spec, stop_tokens, inputs = synthesis(
        model,
        text,
        CONFIG,
        use_cuda,
        ap,
        truncated=False,
        enable_eos_bos_chars=CONFIG.enable_eos_bos_chars,
    )
    if not use_gl:
        waveform = vocoder_model.inference(
            torch.FloatTensor(mel_postnet_spec.T).unsqueeze(0)
        )
        waveform = waveform.flatten()
    if use_cuda:
        waveform = waveform.cpu()
    waveform = waveform.numpy()
    rtf = (time.time() - t_1) / (len(waveform) / ap.sample_rate)
    tps = (time.time() - t_1) / len(waveform)

    print(waveform.shape)
    print(&quot; &gt; Run-time: {}&quot;.format(time.time() - t_1))
    print(&quot; &gt; Real-time factor: {}&quot;.format(rtf))
    print(&quot; &gt; Time per step: {}&quot;.format(tps))
    wavio.write(file_name, waveform, CONFIG.audio[&quot;sample_rate&quot;], sampwidth=2)  # å°† wav å†™å…¥æ–‡ä»¶
    return alignment, mel_postnet_spec, stop_tokens, waveform


tts_run = partial(
    tts, model=model, CONFIG=TTS_CONFIG, use_cuda=use_cuda, ap=ap, use_gl=False
)

if __name__ == &quot;__main__&quot;:
    sentence = &quot;Bill got in the habit of asking himself â€œIs that thought true?â€ and if he wasnâ€™t absolutely certain it was, he just let it go.&quot;
    file_name = &quot;myfile.wav&quot;
    align, spec, stop_tokens, wav = tts(
        model, sentence, file_name, TTS_CONFIG, use_cuda, ap, use_gl=False
    )
</code></pre><p>è¿™æ ·æˆ‘ä»¬çš„ <code>tts_run</code> ä¹Ÿæœ‰äº†ã€‚ æ‹¼å›¾å°±å‡‘é½äº†ã€‚</p><h3 id="UI-æœåŠ¡"><a href="#UI-æœåŠ¡" class="headerlink" title="UI æœåŠ¡"></a>UI æœåŠ¡</h3><h4 id="1-å®‰è£…-1"><a href="#1-å®‰è£…-1" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h4><pre><code class="bash">git clone https://github.com/RasaHQ/rasa-voice-interface.git --depth 1
cd rasa-voice-interface
npm install</code></pre><h4 id="2-è¿è¡Œ"><a href="#2-è¿è¡Œ" class="headerlink" title="2. è¿è¡Œ"></a>2. è¿è¡Œ</h4><pre><code class="bash">npm run serve</code></pre><p>æˆåŠŸå¯åŠ¨æ—¶çš„ç•Œé¢:</p><blockquote><p><img src="https://i.loli.net/2021/01/13/qZVTdsGMCAtaISk.gif" srcset="/img/loading.gif" alt="ezgif.com-video-to-gif.gif"></p></blockquote><p>å’Œ <code>rasa</code> è¿æ¥æˆåŠŸæ—¶çš„ç•Œé¢:</p><blockquote><p><img src="https://i.loli.net/2021/01/13/5JoMd8pENA4OcLY.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote><blockquote><p>pint:<br>ç‚¹å‡» start ä¹‹åï¼Œä¼šè‡ªåŠ¨å®ŒæˆéŸ³é¢‘ä¸Šä¼ ï¼Œä¸éœ€è¦å†åšç‚¹å‡»ã€‚</p></blockquote><h3 id="è¿˜å·®ä¸€ä¸ªï¼Œæ–‡ä»¶æœåŠ¡å™¨"><a href="#è¿˜å·®ä¸€ä¸ªï¼Œæ–‡ä»¶æœåŠ¡å™¨" class="headerlink" title="è¿˜å·®ä¸€ä¸ªï¼Œæ–‡ä»¶æœåŠ¡å™¨"></a>è¿˜å·®ä¸€ä¸ªï¼Œæ–‡ä»¶æœåŠ¡å™¨</h3><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æœ€ç®€å•çš„ï¼Œæ³¨æ„ï¼Œéœ€è¦åœ¨ <code>rasa-demo</code> æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•è¿è¡Œã€‚<br><code>python3 -m http.server 8888</code><br>è¿™æ ·ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ã€‚å¯ä»¥è¿è¡Œ <code>rasa</code> éƒ¨åˆ†çš„ä»£ç äº†ï½</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="RASA-æ€»ç»“"><a href="#RASA-æ€»ç»“" class="headerlink" title="RASA æ€»ç»“"></a>RASA æ€»ç»“</h3><ul><li>åœ¨å¯¹äºä»…éœ€å¤„ç†<strong>è¾“å…¥è¾“å‡º</strong>çš„æ—¶å€™ï¼Œåˆ©ç”¨ <code>channel</code> å®ç°æ˜¯æœ€æ–¹ä¾¿ä¸”æœ€åˆç†çš„ã€‚</li><li><code>rasa core</code> å·²æ˜¯è¿‡å»å¼ã€‚</li><li><code>channel</code> ç›®å‰åŸºäº <code>sanic</code>ï¼Œèƒ½å®ç° <code>rest</code> æˆ–è€… <code>websocket</code>ã€‚</li></ul><h3 id="æœåŠ¡æ€»ç»“"><a href="#æœåŠ¡æ€»ç»“" class="headerlink" title="æœåŠ¡æ€»ç»“"></a>æœåŠ¡æ€»ç»“</h3><p>ä¸Šé¢ä¸ºæ‰€æœ‰çš„ä»£ç ï¼Œä»¥åŠæ¨¡å—çš„æ€»ç»“ã€‚ä½†æ˜¯ï¼Œç¼ºå°‘ä¸€ä¸ªæœåŠ¡é—´çš„è°ƒç”¨ï¼Œæˆ‘ä»¬è¡¥ä¸€ä¸‹ã€‚<br>å…ˆæ¢³ç†ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„æœåŠ¡ã€‚</p><ul><li><code>duckling</code> æ–‡æœ¬æå–</li><li><code>action server</code> <code>rasa</code> è‡ªå®šä¹‰ <code>action</code> çš„å®ç°</li><li><code>rasa server</code> <code>rasa</code> æœ¬èº«çš„æœåŠ¡</li><li><code>ui server</code> å‰ç«¯ <code>UI</code> æœåŠ¡</li><li><code>http.server</code> æ–‡ä»¶ä¸‹è½½æœåŠ¡</li></ul><p>æœåŠ¡è°ƒç”¨å…³ç³»å¦‚ä¸‹:</p><div class="mermaid">graph LR; ui((ui server))-- éŸ³é¢‘æ–‡ä»¶è¯·æ±‚ --> fs((http.server)); fs-- response file -->ui; ui-- request éŸ³é¢‘ -->rasa_s((rasa server)); rasa_s-- socket response-->ui; rasa_s-- nlu -->duckling((duckling)); rasa_s-- nlu -->action((action server)); duckling-- response -->rasa_s; action-- response -->rasa_s;</div><h3 id="ç”¨åˆ°çš„ä¸‰æ–¹åº“çš„æ€»ç»“"><a href="#ç”¨åˆ°çš„ä¸‰æ–¹åº“çš„æ€»ç»“" class="headerlink" title="ç”¨åˆ°çš„ä¸‰æ–¹åº“çš„æ€»ç»“"></a>ç”¨åˆ°çš„ä¸‰æ–¹åº“çš„æ€»ç»“</h3><ul><li><code>wavio</code> <code>wav</code>æ–‡ä»¶çš„è¯»å†™</li><li><code>TTS</code> çš„ç›¸å…³æ“ä½œ</li><li><code>librosa</code> æ–‡ä»¶æ•°æ®è½¬éŸ³é¢‘æ³¢</li><li><code>socketio</code> <code>socket server</code></li><li><code>deepspeech</code> <code>STT</code></li></ul><h3 id="æ‰€æœ‰çš„ä»£ç "><a href="#æ‰€æœ‰çš„ä»£ç " class="headerlink" title="æ‰€æœ‰çš„ä»£ç "></a>æ‰€æœ‰çš„ä»£ç </h3><p><a href="https://github.com/Dustyposa/rasa-demo/tree/voice_demo" target="_blank" rel="noopener">voice-demoåˆ†æ”¯</a><br>ä¸»è¦æ˜¯ <code>utils</code> ä»¥åŠ <code>compoments</code>ã€‚</p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://blog.rasa.com/how-to-build-a-voice-assistant-with-open-source-rasa-and-mozilla-tools/" target="_blank" rel="noopener"><code>ç”¨ mozilla å·¥å…·å’Œ rasa æ„å»ºè¯­éŸ³åŠ©æ‰‹</code></a> (å¥½çœ‹çš„å›¾ä¹Ÿå¼•ç”¨çš„è¿™é‡Œçš„ï¼ˆç•™ä¸‹ä¸å­¦æ— æœ¯çš„æ³ªæ°´))<br><a href="https://github.com/mozilla/TTS" target="_blank" rel="noopener">TTS</a><br><a href="https://deepspeech.readthedocs.io/en/latest/?badge=latest" target="_blank" rel="noopener">DeepSpeech</a><br><a href="https://github.com/RasaHQ/rasa-voice-interface" target="_blank" rel="noopener">rasa voice ui</a></p></blockquote><p><b>æœ¬æ–‡åœ°å€ï¼š <a href="https://dustyposa.github.com/posts/d7e97916/">https://dustyposa.github.com/posts/d7e97916/</a></b></p></div><hr><div><p><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/nlp/">nlp</a> &nbsp; <a class="hover-with-bg" href="/categories/nlp/ai/">ai</a> &nbsp; </span>&nbsp;&nbsp; <span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/rasa/">rasa</a></span></p><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0åè®®</a> ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext row"><div class="post-prev col-6"></div><div class="post-next col-6"><a href="/posts/feca44b4/"><span class="hidden-mobile">Celery ç®€ä»‹ã€æµ‹è¯•ç¯å¢ƒæ­å»ºï¼ˆDockerï¼‰åŠä½¿ç”¨</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-chevron-right"></i></a></div></div></div><div class="comments" id="comments"><script defer src="https://utteranc.es/client.js" repo="Dustyposa/utterances_comments" issue-term="pathname" label="âœ¨ğŸ’¬âœ¨" theme="github-light" crossorigin="anonymous"></script></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc-start"></div><div id="toc"><p class="h5"><i class="far fa-list-alt"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@7/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></main><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><b>Fluid</b></a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script><script>$(document).ready((function(){var t=$("#navbar").height(),o=$("#toc"),s=$("#board-ctn"),c=s.offset().top,i=2*c+s.height();$(window).scroll((function(){var s=$("#toc-start").offset().top-t,c=document.body.scrollTop+document.documentElement.scrollTop;s<=c&&c<=i?o.css({display:"block",position:"fixed",top:t}):c<=s?o.css({position:"",top:""}):c>i&&o.css("display","none")})),tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,headingsOffset:-c}),$(".toc-list-item").length>0&&$("#toc > p").css("visibility","visible");var l=s.css("margin-right");$("#toc-ctn").css({right:l})}))</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-163481315-1","auto"),ga("send","pageview")</script><script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script><script>$(document).ready((function(){$("pre").addClass("prettyprint  "),prettyPrint()}))</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","åŸºäº rasa çš„è¯­éŸ³åŠ©æ‰‹æ­å»º&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready((function(){$(".typed-cursor").addClass("h2"),typed.start()}))</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options={placement:"right",visible:"hover",icon:"â¡"};var el="h1,h2,h3,h4,h5,h6".split(","),res=[];for(item of el)res.push(".markdown-body > "+item);anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#post img:not(.no-zoom img, img[no-zoom])").each((function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)}))</script><script>!function(e,t,a){function r(e){var a=t.createElement("div");a.className="heart",n.push({el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),t.body.appendChild(a)}var n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(e){var a=t.createElement("style");a.type="text/css";try{a.appendChild(t.createTextNode(e))}catch(t){a.styleSheet.cssText=e}t.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),function(){var t="function"==typeof e.onclick&&e.onclick;e.onclick=function(e){t&&t(),r(e)}}(),function e(){for(var a=0;a<n.length;a++)n[a].alpha<=0?(t.body.removeChild(n[a].el),n.splice(a,1)):(n[a].y--,n[a].scale+=.004,n[a].alpha-=.013,n[a].el.style.cssText="left:"+n[a].x+"px;top:"+n[a].y+"px;opacity:"+n[a].alpha+";transform:scale("+n[a].scale+","+n[a].scale+") rotate(45deg);background:"+n[a].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/ni-j.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>