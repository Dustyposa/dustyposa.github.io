<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="ä¸€äº›ç»éªŒçš„è®°å½•ã€‚"><meta name="author" content="Dusty Posa"><meta name="keywords" content="python,python3,process,script"><title>python è¯·æ±‚åˆ†æåŠå¤šæå–å™¨ æå–æ•°æ® - Posaã®ã«ã‚</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"><link rel="stylesheet" href="/css/main.css"><link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Posaã®ã«ã‚</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/">å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/">åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/">æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="/about/">å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(https://i.loli.net/2020/04/14/smYH5uD8Pb7k4oI.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask rgba-black-light flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><p class="mt-3 post-meta"><i class="fas fa-calendar-alt" aria-hidden="true"></i> æ˜ŸæœŸäºŒ, å››æœˆ 7æ—¥ 2020, 9:15 ä¸Šåˆ</p><p class="mt-1"><span class="post-meta"><i class="far fa-chart-bar"></i> 4.4k å­— </span><span class="post-meta"><i class="far fa-clock"></i> 20 åˆ†é’Ÿ</span></p></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><p class="note note-warning">æœ¬æ–‡æœ€åæ›´æ–°äºï¼šæ˜ŸæœŸä¸‰, ä¸€æœˆ 13æ—¥ 2021, 10:56 ä¸Šåˆ</p><div class="markdown-body"><h1 id="è±†ç“£ç”µå½±çš„å¤šæ–¹æ³•è§£æ"><a href="#è±†ç“£ç”µå½±çš„å¤šæ–¹æ³•è§£æ" class="headerlink" title="è±†ç“£ç”µå½±çš„å¤šæ–¹æ³•è§£æ"></a>è±†ç“£ç”µå½±çš„å¤šæ–¹æ³•è§£æ</h1><p><a href="https://movie.douban.com/tag/Top100" target="_blank" rel="noopener">è±†ç“£top100</a></p><p>æœ¬é¡¹ç›®ä¸»è¦æ˜¯æ•°æ®æå–çš„ç»ƒä¹ ,æä¾›äº†5ç§æ•°æ®æå–çš„æ–¹å¼.</p><h3 id="1-åˆ†æç½‘é¡µ-éœ€è¦çš„æ•°æ®è¯·æ±‚åœ°å€åˆ†æ"><a href="#1-åˆ†æç½‘é¡µ-éœ€è¦çš„æ•°æ®è¯·æ±‚åœ°å€åˆ†æ" class="headerlink" title="1. åˆ†æç½‘é¡µ  # éœ€è¦çš„æ•°æ®è¯·æ±‚åœ°å€åˆ†æ"></a>1. <a href="#1-åˆ†æç½‘é¡µç¡®è®¤çˆ¬å–ç›®æ ‡çš„æ•°æ®ç±»å‹">åˆ†æç½‘é¡µ</a> # éœ€è¦çš„æ•°æ®è¯·æ±‚åœ°å€åˆ†æ</h3><h3 id="2-æ­£åˆ™æå–-æ­£åˆ™æå–æ‰€é¡»æ•°æ®"><a href="#2-æ­£åˆ™æå–-æ­£åˆ™æå–æ‰€é¡»æ•°æ®" class="headerlink" title="2. æ­£åˆ™æå–  # æ­£åˆ™æå–æ‰€é¡»æ•°æ®"></a>2. <a href="#1-æ­£åˆ™æå–">æ­£åˆ™æå–</a> # æ­£åˆ™æå–æ‰€é¡»æ•°æ®</h3><h3 id="3-Cssé€‰æ‹©å™¨æå–-åˆ©ç”¨BeautifulSoup4-è¿›è¡Œæå–"><a href="#3-Cssé€‰æ‹©å™¨æå–-åˆ©ç”¨BeautifulSoup4-è¿›è¡Œæå–" class="headerlink" title="3. Cssé€‰æ‹©å™¨æå–  # åˆ©ç”¨BeautifulSoup4 è¿›è¡Œæå–"></a>3. <a href="#2-beautifulsoup-cssé€‰æ‹©å™¨-æå–">Cssé€‰æ‹©å™¨æå–</a> # åˆ©ç”¨BeautifulSoup4 è¿›è¡Œæå–</h3><h3 id="4-Xpathé€‰æ‹©å™¨æå–-åˆ©ç”¨lxmlçš„etreeæ¨¡å—è¿›è¡Œxpathæå–"><a href="#4-Xpathé€‰æ‹©å™¨æå–-åˆ©ç”¨lxmlçš„etreeæ¨¡å—è¿›è¡Œxpathæå–" class="headerlink" title="4. Xpathé€‰æ‹©å™¨æå–  # åˆ©ç”¨lxmlçš„etreeæ¨¡å—è¿›è¡Œxpathæå–"></a>4. <a href="#3-xpath-æå–">Xpathé€‰æ‹©å™¨æå–</a> # åˆ©ç”¨lxmlçš„etreeæ¨¡å—è¿›è¡Œxpathæå–</h3><h3 id="5-jQueryæå–-æœ‰å‰ç«¯çš„çŸ¥è¯†çš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰-åˆ©ç”¨çš„æ˜¯pyqueryæ¨¡å—-èŠ‚ç‚¹é€‰æ‹©è¯­æ³•ä¸jQueryä¸€è‡´"><a href="#5-jQueryæå–-æœ‰å‰ç«¯çš„çŸ¥è¯†çš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰-åˆ©ç”¨çš„æ˜¯pyqueryæ¨¡å—-èŠ‚ç‚¹é€‰æ‹©è¯­æ³•ä¸jQueryä¸€è‡´" class="headerlink" title="5. jQueryæå–  # æœ‰å‰ç«¯çš„çŸ¥è¯†çš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰,åˆ©ç”¨çš„æ˜¯pyqueryæ¨¡å—,èŠ‚ç‚¹é€‰æ‹©è¯­æ³•ä¸jQueryä¸€è‡´"></a>5. <a href="#4-pyquery-çš„æ•°æ®æå–">jQueryæå–</a> # æœ‰å‰ç«¯çš„çŸ¥è¯†çš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰,åˆ©ç”¨çš„æ˜¯pyqueryæ¨¡å—,èŠ‚ç‚¹é€‰æ‹©è¯­æ³•ä¸jQueryä¸€è‡´</h3><h3 id="6-Scrapy-parsel-æ··åˆæå–å™¨-åˆ©ç”¨scrapyçš„Selectoræ¨¡å—è¿›è¡Œæ··åˆæå–"><a href="#6-Scrapy-parsel-æ··åˆæå–å™¨-åˆ©ç”¨scrapyçš„Selectoræ¨¡å—è¿›è¡Œæ··åˆæå–" class="headerlink" title="6. Scrapy/parsel æ··åˆæå–å™¨  # åˆ©ç”¨scrapyçš„Selectoræ¨¡å—è¿›è¡Œæ··åˆæå–"></a>6. <a href="#5-scrapy-æ··åˆæå–">Scrapy/parsel æ··åˆæå–å™¨</a> # åˆ©ç”¨scrapyçš„Selectoræ¨¡å—è¿›è¡Œæ··åˆæå–</h3><h3 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7. æ€»ç»“"></a>7. <a href="#æ€»ç»“">æ€»ç»“</a></h3><h4 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a><a href="./douban_spider.ipynb">å®Œæ•´ä»£ç </a></h4><h3 id="1-åˆ†æç½‘é¡µï¼Œç¡®è®¤çˆ¬å–ç›®æ ‡çš„æ•°æ®ç±»å‹ã€‚"><a href="#1-åˆ†æç½‘é¡µï¼Œç¡®è®¤çˆ¬å–ç›®æ ‡çš„æ•°æ®ç±»å‹ã€‚" class="headerlink" title="1. åˆ†æç½‘é¡µï¼Œç¡®è®¤çˆ¬å–ç›®æ ‡çš„æ•°æ®ç±»å‹ã€‚"></a>1. åˆ†æç½‘é¡µï¼Œç¡®è®¤çˆ¬å–ç›®æ ‡çš„æ•°æ®ç±»å‹ã€‚</h3><ul><li><h4 id="æ‰“å¼€-ç›®æ ‡url-å®šä½æ•°æ®ä½ç½®"><a href="#æ‰“å¼€-ç›®æ ‡url-å®šä½æ•°æ®ä½ç½®" class="headerlink" title="æ‰“å¼€ ç›®æ ‡url, å®šä½æ•°æ®ä½ç½®"></a>æ‰“å¼€ <a href="https://movie.douban.com/tag/Top100" target="_blank" rel="noopener">ç›®æ ‡url</a>, å®šä½æ•°æ®ä½ç½®</h4><img src="https://img-blog.csdnimg.cn/2019090309464243.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="é¦–é¡µ"></li><li><h4 id="å®šä½éœ€è¦çš„æ•°æ®ä½ç½®ï¼ŒæŸ¥çœ‹çˆ¬å–ç›®æ ‡ã€‚"><a href="#å®šä½éœ€è¦çš„æ•°æ®ä½ç½®ï¼ŒæŸ¥çœ‹çˆ¬å–ç›®æ ‡ã€‚" class="headerlink" title="å®šä½éœ€è¦çš„æ•°æ®ä½ç½®ï¼ŒæŸ¥çœ‹çˆ¬å–ç›®æ ‡ã€‚"></a>å®šä½éœ€è¦çš„æ•°æ®ä½ç½®ï¼ŒæŸ¥çœ‹çˆ¬å–ç›®æ ‡ã€‚</h4><img src="https://img-blog.csdnimg.cn/20190903094719997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="æ•°æ®æº"><br>ç”±å›¾å¯å¾—ï¼Œæˆ‘ä»¬éœ€è¦çš„æ•°æ®åˆ†åˆ«ä¸ºï¼Œ[â€˜æµ·æŠ¥â€™, â€˜ç”µå½±åâ€™, â€˜ä¸Šæ˜ æ—¥æœŸâ€™, â€˜æ¼”å‘˜â€™, â€˜è¯„åˆ†â€™, â€˜è¯„ä»·äººæ•°â€™]</li><li><h4 id="æŸ¥çœ‹è¯·æ±‚ï¼Œåˆ†ææ•°æ®æ¥æºè¯·æ±‚ï¼ˆF12-gt-gt-network-æ‰“å¼€è¯·æ±‚ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼‰"><a href="#æŸ¥çœ‹è¯·æ±‚ï¼Œåˆ†ææ•°æ®æ¥æºè¯·æ±‚ï¼ˆF12-gt-gt-network-æ‰“å¼€è¯·æ±‚ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼‰" class="headerlink" title="æŸ¥çœ‹è¯·æ±‚ï¼Œåˆ†ææ•°æ®æ¥æºè¯·æ±‚ï¼ˆF12 &gt;&gt; network æ‰“å¼€è¯·æ±‚ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼‰"></a>æŸ¥çœ‹è¯·æ±‚ï¼Œåˆ†ææ•°æ®æ¥æºè¯·æ±‚ï¼ˆF12 &gt;&gt; network æ‰“å¼€è¯·æ±‚ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼‰</h4><img src="https://img-blog.csdnimg.cn/20190903094745651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="æŠ“åŒ…"></li><li><h4 id="ç¡®è®¤æ•°æ®è¯·æ±‚æ¥æº-Ctrl-F-æœç´¢-è¾›å¾·å‹’"><a href="#ç¡®è®¤æ•°æ®è¯·æ±‚æ¥æº-Ctrl-F-æœç´¢-è¾›å¾·å‹’" class="headerlink" title="ç¡®è®¤æ•°æ®è¯·æ±‚æ¥æº(Ctrl + F æœç´¢: è¾›å¾·å‹’)"></a>ç¡®è®¤æ•°æ®è¯·æ±‚æ¥æº(Ctrl + F æœç´¢: è¾›å¾·å‹’)</h4><img src="https://img-blog.csdnimg.cn/20190903094815715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="å®šä½è¯·æ±‚"><br>ä¸Šå›¾å¯çŸ¥ï¼Œè¯¥è¯·æ±‚åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å°±èƒ½è½»æ¾çš„ç¡®å®šæ¥æºæ‹‰ï¼</li><li><h4 id="æŸ¥çœ‹headersï¼Œåˆ†æè¯·æ±‚æŠ¥æ–‡"><a href="#æŸ¥çœ‹headersï¼Œåˆ†æè¯·æ±‚æŠ¥æ–‡" class="headerlink" title="æŸ¥çœ‹headersï¼Œåˆ†æè¯·æ±‚æŠ¥æ–‡"></a>æŸ¥çœ‹headersï¼Œåˆ†æè¯·æ±‚æŠ¥æ–‡</h4><img src="https://img-blog.csdnimg.cn/2019090309491356.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ†æç»“æœå¦‚å›¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</li></ul><table><thead><tr><th align="left">ä¿¡æ¯</th><th>ç»“æœ</th></tr></thead><tbody><tr><td align="left">è¯·æ±‚åœ°å€</td><td><a href="https://movie.douban.com/tag/Top100" target="_blank" rel="noopener">https://movie.douban.com/tag/Top100</a></td></tr><tr><td align="left">è¯·æ±‚æ–¹æ³•</td><td>Get</td></tr><tr><td align="left">å“åº”æ ¼å¼</td><td>text æ–‡æœ¬</td></tr><tr><td align="left">ç¼–ç </td><td>UTF-8</td></tr></tbody></table><h2 id="2-åˆ©ç”¨requestsè¿›è¡Œè¯·æ±‚æµ‹è¯•"><a href="#2-åˆ©ç”¨requestsè¿›è¡Œè¯·æ±‚æµ‹è¯•" class="headerlink" title="2. åˆ©ç”¨requestsè¿›è¡Œè¯·æ±‚æµ‹è¯•"></a>2. åˆ©ç”¨requestsè¿›è¡Œè¯·æ±‚æµ‹è¯•</h2><p><code>requests.get</code><br>å®šä¹‰è¯·æ±‚å‡½æ•°ï¼Œ<code>get_data</code><br>è¿”å›<code>text</code>æ•°æ®</p><p>æ¨¡å—å¯¼å…¥</p><pre><code class="python">&gt;&gt;&gt; import requests
&gt;&gt;&gt; from requests.exceptions import HTTPError</code></pre><pre><code class="python">def get_data(url):

    response = requests.get(url)
    if response.status_code == requests.codes.ok:  # æ£€æµ‹çŠ¶æ€ç 
        return response.text  # è¿”å›å“åº”çš„æ–‡æœ¬ä¿¡æ¯
    else:
        response.raise_for_status()  # 4xx 5xx æ—¶,å¼•å‡ºé”™è¯¯ ä»£æ›¿ raise requests.exception.HTTPError

 url = &quot;https://movie.douban.com/tag/Top100&quot;
data = get_data(url)  # è·å–æ•°æ®
data_res = {}  # å­˜å‚¨æ•°æ®çš„åˆå§‹åŒ–å­—å…¸
data # æŸ¥çœ‹æ•°æ®</code></pre><pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-cmn-Hans&quot; class=&quot;ua-windows ua-webkit&quot;&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
......</code></pre><h2 id="3-æå–æ•°æ®"><a href="#3-æå–æ•°æ®" class="headerlink" title="3. æå–æ•°æ®"></a>3. æå–æ•°æ®</h2><ul><li>æ­£åˆ™æå–</li><li>BeautifulSoup æå–</li><li>Xpath æå–</li><li>pyquery æå–</li><li>scrapy æ··åˆæå–</li></ul><h3 id="1-æ­£åˆ™æå–"><a href="#1-æ­£åˆ™æå–" class="headerlink" title="1. æ­£åˆ™æå–"></a>1. æ­£åˆ™æå–</h3><ul><li>è§‚å¯Ÿæ•°æ®ä½ç½®<br><img src="https://img-blog.csdnimg.cn/20190903094936617.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="æ­£åˆ™æ•°æ®ä½ç½®"></li></ul><p>å¯¼å…¥æ¨¡å—</p><pre><code class="python">&gt;&gt;&gt; import re</code></pre><h3 id="æå–-æµ·æŠ¥åœ°å€ä»¥åŠç”µå½±åç§°"><a href="#æå–-æµ·æŠ¥åœ°å€ä»¥åŠç”µå½±åç§°" class="headerlink" title="æå– æµ·æŠ¥åœ°å€ä»¥åŠç”µå½±åç§°"></a>æå– æµ·æŠ¥åœ°å€ä»¥åŠç”µå½±åç§°</h3><p><strong>é€šè¿‡æŸ¥çœ‹è¯¥è¯·æ±‚çš„å“åº”å†…å®¹å¿«é€Ÿè¿›è¡Œå¤åˆ¶åŒ¹é…,å¦‚ä¸‹å›¾æœç´¢:</strong><br><img src="https://img-blog.csdnimg.cn/20190903094959517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="æ­£åˆ™è·å–æ•°æ®"><br>ç”¨åˆ°çš„åŒ¹é…è§„åˆ™æç¤º:</p><ul><li>â€œ.â€ è¡¨ç¤ºä»»æ„éç©ºæ ¼æ¢è¡Œç­‰å­—ç¬¦</li><li>â€œ.*?â€ è¡¨ç¤ºè´ªå©ªåŒ¹é…,æœ€å°‘åŒ¹é…ä¸€æ¬¡</li><li>â€œ()â€ è¡¨ç¤ºæå–()ä¸­çš„å†…å®¹</li><li>â€œ\wâ€ è¡¨ç¤ºæ­£å¸¸å­—ç¬¦,æ¯”å¦‚è‹±æ–‡å­—æ¯,ä¸­æ–‡ç­‰å¸¸è§æ–‡å­—</li><li>â€œ.+â€ è¡¨ç¤ºè‡³å°‘åŒ¹é…ä¸€æ¬¡ä»»æ„å­—ç¬¦</li></ul><pre><code class="python">&gt;&gt;&gt; # è®¾ç½®æå–è¡¨è¾¾å¼ 
&gt;&gt;&gt; poster_pattern = re.compile(r&quot;&quot;&quot;&lt;a class=&quot;nbg&quot; href=&quot;.*?&quot;  title=&quot;.*?&quot;&gt;.*?&lt;img src=&quot;(.*?)&quot; width=&quot;75&quot; alt=&quot;(.*?)&quot; class=&quot;&quot;/&gt;.*?&lt;/a&gt;&quot;&quot;&quot;, re.S)  # æµ·æŠ¥çš„æ­£åˆ™è¡¨è¾¾å¼
&gt;&gt;&gt; movie_name_pattern = re.compile(r&quot;&quot;&quot; &lt;div class=&quot;pl2&quot;&gt;.*? &lt;a href=&quot;.*?&quot;  class=&quot;&quot;&gt;.*?(\w+).*?&lt;span style=&quot;font-size:13px;&quot;&gt;(.*?)&lt;/span&gt;.*?&lt;/a&gt;&quot;&quot;&quot;, re.S)  # ç”µå½±åæ­£åˆ™è¡¨è¾¾å¼
&gt;&gt;&gt; poster_res = re.findall(poster_pattern, data)  # è·å–æ‰€æœ‰åŒ¹é…ç»“æœ
&gt;&gt;&gt; movie_name_res = re.findall(movie_name_pattern, data)
&gt;&gt;&gt; poster_res, movie_name_res
......
(&#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p1910902213.jpg&#39;,
&#39;ä½ä¿—å°è¯´&#39;),
(&#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p1665997400.jpg&#39;,
&#39;ç¾ä¸½å¿ƒçµ&#39;)],
[(&#39;è¾›å¾·å‹’çš„åå•&#39;, &#39;èˆ’ç‰¹æ‹‰çš„åå•(æ¸¯) / è¾›å¾·å‹’åå•&#39;),
(&#39;ç‹©çŒ&#39;, &#39;è°è¨€çš„çƒ™å°(å°) / è¯¬ç½‘(æ¸¯)&#39;),
(&#39;ç¾å›½å¾€äº‹&#39;, &#39;å››æµ·å…„å¼Ÿ(å°) / ä¹‰è–„äº‘å¤©(æ¸¯)&#39;),
......</code></pre><p><strong>æŸ¥çœ‹ç»“æœå¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜, æˆ‘ä»¬ç”¨é•¿åº¦æ¯”è¾ƒæ¥çœ‹çœ‹æ•°é‡æ˜¯å¦ä¸€è‡´</strong></p><pre><code class="python">&gt;&gt;&gt; len(poster_res) == len(movie_name_res)
True</code></pre><p><strong>é•¿åº¦ä¸€è‡´,çœ‹æ¥åŒ¹é…è§„åˆ™åœ¨è¿™é‡Œæ²¡é—®é¢˜</strong><br>æˆ‘ä»¬å°†æå–åˆ°çš„æ•°æ®å­˜å‚¨åˆ°æˆ‘ä»¬çš„æ•°æ®ç»“æ„<code>data_res</code>ä¸­</p><pre><code class="python">for poster, movie_name in zip(poster_res, movie_name_res):  # å‹ç¼©éå†
    # è¿›è¡Œåç§°éªŒè¯ï¼Œæ˜¯å¦å¯¹åº”,
    name1 = poster[1]
    name2 = movie_name[0]
    if name1 == name2:
        tmp_dict = data_res.get(name1, {})  # åˆå§‹åŒ–å­—å…¸
        tmp_dict.update({&quot;poster&quot;: poster[0]})  # å­—å…¸æ›´æ–°
        tmp_dict.update({&quot;else_name&quot;: movie_name[1]})  # å­—å…¸æ›´æ–°
        data_res[name1] = tmp_dict
data_res</code></pre><pre><code>{
&#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;,
  &#39;else_name&#39;: &#39;èˆ’ç‰¹æ‹‰çš„åå•(æ¸¯) / è¾›å¾·å‹’åå•&#39;},
 &#39;ç‹©çŒ&#39;: {&#39;poster&#39;: &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p1546987967.jpg&#39;,
  &#39;else_name&#39;: &#39;è°è¨€çš„çƒ™å°(å°) / è¯¬ç½‘(æ¸¯)&#39;},
 &#39;ç¾å›½å¾€äº‹&#39;: {&#39;poster&#39;: &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p477229647.jpg&#39;,
  &#39;else_name&#39;: &#39;å››æµ·å…„å¼Ÿ(å°) / ä¹‰è–„äº‘å¤©(æ¸¯)&#39;},
 &#39;åäºŒæ€’æ±‰&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p2173577632.jpg&#39;,
 ......
 }</code></pre><p><strong>æˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹æ³•,æå–å…¶ä»–éœ€è¦çš„æ•°æ®</strong><br><strong><em>è¿™é‡Œæœ‰ä¸ªå°æŠ€å·§,ç”¨é¢å¤–çš„å­—æ®µæ¥å¾—åˆ°å”¯ä¸€åŒ¹é…, å¦‚ä¸‹å›¾:</em></strong><br>éœ€è¦çš„æ•°æ®:<br><img src="https://img-blog.csdnimg.cn/20190903095020573.png" srcset="/img/loading.gif" alt="unique1"><br>é¢å¤–æ•°æ®åŒ¹é…:<br><img src="https://img-blog.csdnimg.cn/20190903095034683.png" srcset="/img/loading.gif" alt="unique2"></p><h4 id="æ•´ä½“æå–"><a href="#æ•´ä½“æå–" class="headerlink" title="æ•´ä½“æå–"></a>æ•´ä½“æå–</h4><p><strong>ç”±äºæ‰€æœ‰æ•°æ®éƒ½é›†ä¸­åœ¨ä¸€ä¸ªå—ï¼Œå¦‚ä¸‹å›¾ï¼š</strong><br><img src="https://img-blog.csdnimg.cn/20190903095100811.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3R5cG9zYQ==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰€æœ‰æˆ‘ä»¬å°±ä¸€æ¬¡æ€§å…¨éƒ¨æå–ï¼Œæ–¹ä¾¿æ•°æ®çš„æ”¶é›†.<br>ç”±äºæœ‰äº›æ˜¯ç”µå½±å€¼æœ‰ä¸€ä¸ªå¹´ä»½ï¼Œæ‰€ä»¥åŒ¹é…ä¸å¥½åŒ¹é…ï¼Œæˆ‘ä»¬åŒ¹é…æ•´ä½“ååˆ©ç”¨â€/â€œè¿›è¡Œåˆ†å‰²å†æŒ‘é€‰.<br><em>PS: å…¶å®æ­£åˆ™åŒ¹é…è¿™ç§å¾ˆå¤šå­—æ®µçš„å®¹æ˜“å‡ºé”™ï¼Œæ¢è¡Œä¹‹ç±»çš„å­—ç¬¦å®¹æ˜“å¿˜è®°æ›¿ä»£ï¼Œæ‰€ä»¥å»ºè®®ä¸€ç‚¹ä¸€ç‚¹çš„å¢åŠ åŒ¹é…è¡¨è¾¾å¼çš„é•¿åº¦.</em></p><pre><code class="python">&gt;&gt;&gt; total_pattern = re.compile(&quot;&quot;&quot;&lt;p class=&quot;ul&quot;&gt;.*?&lt;a class=&quot;nbg&quot; href=&quot;.*?&quot;  title=&quot;(.*?)&quot;&gt;.*?&lt;img src=&quot;(.*?)&quot; width=&quot;75&quot;.*?&lt;div class=&quot;pl2&quot;&gt;.*?&lt;a href=&quot;.*?&quot;  class=&quot;&quot;&gt;.*?(\w+).*?style=&quot;font-size:13px;&quot;&gt;(.*?)&lt;/span&gt;.*?class=&quot;pl&quot;&gt;(.*?)&lt;/p&gt;.*?class=&quot;star clearfix&quot;&gt;.*?&quot;allstar45&quot;&gt;&lt;/span&gt;.*?&quot;rating_nums&quot;&gt;(.*?)&lt;/span&gt;.*?&lt;span class=&quot;pl&quot;&gt;\((.*?)\)&lt;/span&gt;.*?&lt;div id=&quot;.*?&quot;&gt;&lt;/div&gt;&quot;&quot;&quot;, re.S)
&gt;&gt;&gt; res = re.findall(total_pattern, data)
&gt;&gt;&gt; res</code></pre><pre><code>[
(&#39;ç‹©çŒ&#39;,
  &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p1546987967.jpg&#39;,
  &#39;ç‹©çŒ&#39;,
  &#39;è°è¨€çš„çƒ™å°(å°) / è¯¬ç½‘(æ¸¯)&#39;,
  &#39;2012-05-20(æˆ›çº³ç”µå½±èŠ‚) / 2013-01-10(ä¸¹éº¦) / éº¦æ–¯Â·ç±³ç§‘å°”æ£® / æ‰˜ç›æ–¯Â·åšÂ·æ‹‰æ£® / å®‰å¦®å¡Â·éŸ¦å¾·ç§‘æ™® / æ‹‰ä¸Â·å¼—æ ¼æ–¯æ‰˜å§† / è‹è¥¿Â·æ²ƒå¾· / å®‰å¦®Â·è·¯æ˜“ä¸Â·å“ˆè¾› / æ‹‰æ–¯Â·å…°ç‰¹ / äºšå†å±±å¾·æ‹‰Â·æ‹‰å¸•æ³¢ç‰¹ / æ‹‰æ–¯ç©†æ–¯Â·æ—å¾·Â·é²å®¾ / ä¸¹éº¦ / ç‘å…¸ / æ‰˜é©¬æ–¯Â·æ¸©ç‰¹ä¼¯æ ¼...&#39;,
  &#39;9.1&#39;,
  &#39;184560äººè¯„ä»·&#39;),
 (&#39;ç¾å›½å¾€äº‹&#39;,
  &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p477229647.jpg&#39;,
  &#39;ç¾å›½å¾€äº‹&#39;,
......
]</code></pre><h4 id="è§‚å¯Ÿæ•´ä½“æ•°æ®æƒ…å†µï¼Œæå–æ•°æ®"><a href="#è§‚å¯Ÿæ•´ä½“æ•°æ®æƒ…å†µï¼Œæå–æ•°æ®" class="headerlink" title="è§‚å¯Ÿæ•´ä½“æ•°æ®æƒ…å†µï¼Œæå–æ•°æ®"></a>è§‚å¯Ÿæ•´ä½“æ•°æ®æƒ…å†µï¼Œæå–æ•°æ®</h4><p><img src="https://img-blog.csdnimg.cn/20190903095121985.png" srcset="/img/loading.gif" alt="å¤„ç†æ—¶é—´"></p><pre><code class="python">def get_time_actor(data):
    &quot;&quot;&quot;
    è·å–å¤„ç†åçš„æ—¶é—´å’Œæ¼”å‘˜æ•°æ®
    :param data: 
    :return: 
    &quot;&quot;&quot;
    tmp_data = data.split(&quot; / &quot;)
    ind = 1
    for i, v in enumerate(tmp_data):
        if v[:4].isdigit():  # åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—
            ind += 1
        else:
            break
        return tmp_data[:ind], tmp_data[ind:]</code></pre><pre><code class="python">for tmp_data in res:
    tmp = data_res.get(tmp_data[0], {})  # è·å–åŸæ¥çš„å­—å…¸æ•°æ®
    if tmp_data[0] == tmp_data[2]:  # æ£€æµ‹æ•°æ®æ˜¯å¦å¯¹é½
        tmp.update({&quot;movie_name&quot;: tmp_data[0], &quot;poster_url&quot;: tmp_data[1], &quot;other_name&quot;: tmp_data[3], &quot;score&quot;: float(tmp_data[-2]), &quot;comment_people&quot;: tmp_data[-1].replace(&quot;äººè¯„ä»·&quot;, &quot;&quot;)})  # æ›´æ–°æ•°æ®
        time_data, actor = get_time_actor(tmp_data[-3])
        tmp.update({&quot;release_time&quot;: time_data, &quot;actor&quot;: actor})
        data_res[tmp_data[0]] = tmp
    else:
        print(&quot;æ•°æ®æœ‰è¯¯&quot;)
print(data_res)</code></pre><pre><code>    {
    &#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;, &#39;else_name&#39;: &#39;èˆ’ç‰¹æ‹‰çš„åå•(æ¸¯) / è¾›å¾·å‹’åå•&#39;}, &#39;ç‹©çŒ&#39;: {&#39;poster&#39;: &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p1546987967.jpg&#39;, &#39;else_name&#39;: &#39;è°è¨€çš„çƒ™å°(å°) / è¯¬ç½‘(æ¸¯)&#39;, &#39;movie_name&#39;: &#39;ç‹©çŒ&#39;, &#39;poster_url&#39;: &#39;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p1546987967.jpg&#39;, &#39;other_name&#39;: &#39;è°è¨€çš„çƒ™å°(å°) / è¯¬ç½‘(æ¸¯)&#39;,
    .....
    }</code></pre><h2 id="2-BeautifulSoup-ï¼ˆcssé€‰æ‹©å™¨ï¼‰-æå–"><a href="#2-BeautifulSoup-ï¼ˆcssé€‰æ‹©å™¨ï¼‰-æå–" class="headerlink" title="2. BeautifulSoup ï¼ˆcssé€‰æ‹©å™¨ï¼‰ æå–"></a>2. BeautifulSoup ï¼ˆcssé€‰æ‹©å™¨ï¼‰ æå–</h2><p>å¯¼å…¥æ¨¡å—</p><pre><code class="python">&gt;&gt;&gt; from bs4 import BeautifulSoup</code></pre><pre><code class="python">&gt;&gt;&gt; soup = BeautifulSoup(data, &quot;lxml&quot;)  # åˆå§‹åŒ–soupå¯¹è±¡</code></pre><h4 id="åˆ©ç”¨cssé€‰æ‹©å™¨é€ä¸€è·å–æ•°æ®"><a href="#åˆ©ç”¨cssé€‰æ‹©å™¨é€ä¸€è·å–æ•°æ®" class="headerlink" title="åˆ©ç”¨cssé€‰æ‹©å™¨é€ä¸€è·å–æ•°æ®"></a>åˆ©ç”¨cssé€‰æ‹©å™¨é€ä¸€è·å–æ•°æ®</h4><p><strong>poster</strong>: <code>&quot;.nbg img&quot;</code><br><strong>movie_name</strong>: <code>&quot;.pl2 a&quot;</code><br><strong>time_actor</strong>: <code>&quot;.pl2 p.pl&quot;</code><br><strong>score</strong>: <code>&quot;.rating_nums&quot;</code><br><strong>comment_people</strong>: <code>&quot;.star.clearfix .pl&quot;</code></p><p><strong><em>PS:</em></strong></p><ul><li>â€œ.â€ è¡¨ç¤ºclass</li><li>â€œ â€œè¡¨ç¤ºå­å­™èŠ‚ç‚¹</li><li>img å°±æ˜¯imgèŠ‚ç‚¹</li><li>a å°±æ˜¯aèŠ‚ç‚¹</li><li>â€œ#abdâ€ è¡¨ç¤º id=â€abcâ€çš„èŠ‚ç‚¹</li></ul><pre><code class="python">&gt;&gt;&gt; poster = soup.select(&quot;.nbg img&quot;)  # æµ·æŠ¥
&gt;&gt;&gt; movie_name = soup.select(&quot;.pl2 a&quot;)  # ç”µå½±åç§°
&gt;&gt;&gt; time_actor = soup.select(&quot;.pl2 p.pl&quot;)  # ä¸Šæ˜ æ—¶é—´åŠæ¼”å‘˜
&gt;&gt;&gt; score = soup.select(&quot;.rating_nums&quot;)  # ç”µå½±è¯„åˆ†
&gt;&gt;&gt; comment_people = soup.select(&quot;.star.clearfix .pl&quot;)  # è¯„åˆ†äººæ•°
&gt;&gt;&gt; movie_data = {}  # å­˜å‚¨ç»“æ„</code></pre><h4 id="æ‰¹é‡è·å–æ•°æ®"><a href="#æ‰¹é‡è·å–æ•°æ®" class="headerlink" title="æ‰¹é‡è·å–æ•°æ®"></a>æ‰¹é‡è·å–æ•°æ®</h4><pre><code class="python">for p, m, t, s, c in zip(poster, movie_name, time_actor, score, comment_people):
    pos = p.get(&quot;src&quot;)  # æµ·æŠ¥åœ°å€
    mov = m.get_text().replace(m.select(&quot;span&quot;)[0].get_text(), &quot;&quot;)  # ç”µå½±åç§°
    mov = mov.replace(&quot;/&quot;, &quot;&quot;).strip()  # å»æ‰ä¸éœ€è¦çš„å­—ç¬¦
    other_name = m.select(&quot;span&quot;)[0].get_text()  # é¢å¤–åå­—
    release_time, actor = get_time_actor(t.get_text())
    sco = s.get_text()
    comment = c.get_text()
    movie_data.update({mov: {&quot;poster&quot;: pos, &quot;movie_name&quot;: mov, &quot;other_name&quot;: other_name, &quot;release_time&quot;: release_time, &quot;actor&quot;: actor, &quot;score&quot;: sco, &quot;comment&quot;: comment}})
print(movie_data)</code></pre><pre><code>    {
    &#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;, &#39;movie_name&#39;: &#39;è¾›å¾·å‹’çš„åå•&#39;, &#39;other_name&#39;: &#39;èˆ’ç‰¹æ‹‰çš„åå•(æ¸¯) / è¾›å¾·å‹’åå•&#39;, &#39;release_time&#39;: [&#39;1993-11-30(åç››é¡¿é¦–æ˜ )&#39;, &#39;1994-02-04(ç¾å›½)&#39;], &#39;actor&#39;: [&#39;è¿å§†Â·å°¼æ£®&#39;, &#39;æœ¬Â·é‡‘æ–¯åˆ©&#39;, &#39;æ‹‰å°”å¤«Â·è´¹å› æ–¯&#39;, &#39;å¡ç½—ç³Â·å¤å¤šå°”&#39;, &#39;ä¹”çº³æ£®Â·è¨åŠ å°”&#39;, &#39;è‰¾ä¼¯ä¸Â·æˆ´ç»´å…¹&#39;, &#39;é©¬å°”æˆˆè¨Â·æ ¼è´å°”&#39;, &#39;é©¬å…‹Â·ä¼Šç“¦æ¶…&#39;, &#39;ç¢§ç¿ æ–¯Â·é©¬ç§‘æ‹‰&#39;, &#39;å®‰å¾·çƒˆÂ·ç‘ŸéŸ¦æ—&#39;, &#39;å¼—é‡Œå¾·é‡Œå¸ŒÂ·å†¯Â·å›¾æ©&#39;, &#39;å…‹é½æ–¯èŒ¨æ‰˜å¤«Â·æ‹‰å¤«ç‰¹...&#39;], &#39;score&#39;: &#39;9.5&#39;, &#39;comment&#39;: &#39;(571888äººè¯„ä»·)&#39;}, &#39;ç‹©çŒ&#39;: {&#39;poster&#39;: &#39;https://img1.doubanio
    ......
    }</code></pre><h2 id="3-Xpath-æå–"><a href="#3-Xpath-æå–" class="headerlink" title="3. Xpath æå–"></a>3. Xpath æå–</h2><pre><code class="python">&gt;&gt;&gt; from lxml import etree  # å¯¼å…¥xpathæ¨¡å—</code></pre><pre><code class="python">&gt;&gt;&gt; xpath_data = etree.HTML(data)  # åˆå§‹åŒ–xpathç»“æ„</code></pre><p>å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¯•xpathè¡¨è¾¾å¼,å¦‚ä¸‹å›¾:<br>[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥(img-y8TSyP0X-1567474955837)(./images/xpath1.png)]<br><strong>ä¸‹ä¾‹ç”¨åˆ°çš„xpathè¯­æ³•è§£é‡Š:</strong></p><ul><li>â€œ//â€œ # ä»£è¡¨ä»æ ¹èŠ‚ç‚¹æœç´¢</li><li>â€œ//aâ€ # æœç´¢æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰aæ ‡ç­¾</li><li>â€œ//a[@class=â€nbg]â€ # æœç´¢class=â€nbgâ€çš„aæ ‡ç­¾</li><li>â€œâ€¦/aâ€ # æœç´¢ä»â€¦èŠ‚ç‚¹å¼€å§‹çš„å­aæ ‡ç­¾</li><li>â€œâ€¦/img/@srcâ€ # è·å–å½“å‰imgæ ‡ç­¾çš„srcå±æ€§</li><li>â€œâ€¦/p/text()â€ # è·å–å½“å‰pæ ‡ç­¾ä¸‹çš„æ–‡æœ¬</li><li>â€œâ€¦/p//text()â€ # è·å–å½“å‰pæ ‡ç­¾åçš„æ‰€æœ‰æ–‡æœ¬(å­å­™æ–‡æœ¬)</li></ul><pre><code class="python">&gt;&gt;&gt; poster = xpath_data.xpath(&#39;//a[@class=&quot;nbg&quot;]/img/@src&#39;)  # è·å–æµ·æŠ¥
&gt;&gt;&gt; movie_name = xpath_data.xpath(&#39;//div[@class=&quot;pl2&quot;]/a/text()&#39;)  # è·å–ç”µå½±å
&gt;&gt;&gt; other_name = xpath_data.xpath(&#39;//div[@class=&quot;pl2&quot;]/a/span/text()&#39;)  # è·å–ç”µå½±åˆ«å
&gt;&gt;&gt; time_actor = xpath_data.xpath(&#39;//div[@class=&quot;pl2&quot;]/p/text()&#39;)  # è·å–æ—¶é—´å’Œæ¼”å‘˜
&gt;&gt;&gt; score = xpath_data.xpath(&#39;//span[@class=&quot;rating_nums&quot;]/text()&#39;)  # è·å–è¯„åˆ†
&gt;&gt;&gt; comment_people = xpath_data.xpath(&#39;//span[@class=&quot;pl&quot;]/text()&#39;)  # è¯„åˆ†äººæ•°
&gt;&gt;&gt; movie_data = {}</code></pre><h4 id="åŒæ ·è¿›è¡Œæ•°æ®æ”¶é›†"><a href="#åŒæ ·è¿›è¡Œæ•°æ®æ”¶é›†" class="headerlink" title="åŒæ ·è¿›è¡Œæ•°æ®æ”¶é›†"></a>åŒæ ·è¿›è¡Œæ•°æ®æ”¶é›†</h4><pre><code class="python">for p, m, o, t, s, c in zip(poster, movie_name, other_name, time_actor, score, comment_people):
    m = m.replace(&quot;/&quot;, &quot;&quot;).strip()
    release_time, actor = get_time_actor(t)
    movie_data.update({m: {&quot;poster&quot;: p, &quot;movie_name&quot;: m, &quot;other_name&quot;: t, &quot;release_time&quot;: release_time, &quot;actor&quot;: actor, &quot;score&quot;: s, &quot;comment&quot;: c}})
print(movie_data)</code></pre><pre><code>    {
    &#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;, &#39;movie_name&#39;: &#39;è¾›å¾·å‹’çš„åå•&#39;, &#39;other_name&#39;: &#39;1993-11-30(åç››é¡¿é¦–æ˜ ) / 1994-02-04(ç¾å›½) / è¿å§†Â·å°¼æ£® / æœ¬Â·é‡‘æ–¯åˆ© / æ‹‰å°”å¤«Â·è´¹å› æ–¯ / å¡ç½—ç³Â·å¤å¤šå°” /
    ......
    }</code></pre><h2 id="4-Pyquery-çš„æ•°æ®æå–"><a href="#4-Pyquery-çš„æ•°æ®æå–" class="headerlink" title="4. Pyquery çš„æ•°æ®æå–"></a>4. Pyquery çš„æ•°æ®æå–</h2><p>ä¸»è¦åˆ©ç”¨jqueryçš„å®šä½æ–¹å¼ï¼Œ<br>å¦‚ â€œ.nameâ€ è¡¨ç¤º class=â€nameâ€<br>â€œ#nameâ€ è¡¨ç¤º id=â€nameâ€<br>ä»¥ä¸‹ä¾‹å­ä¸­:</p><ul><li>â€œa.nbgâ€ # è¡¨ç¤º a class=â€nbgâ€</li><li>â€œa imgâ€ # è¡¨ç¤º aæ ‡ç­¾çš„å­å­™imgæ ‡ç­¾</li><li>.remove() # è¡¨ç¤ºç§»é™¤è¯¥èŠ‚ç‚¹</li><li>.items() # å½“é€‰ä¸­å¤šä¸ªèŠ‚ç‚¹æ—¶,éœ€è¦ä½¿ç”¨.items() ç”Ÿæˆå¯éå†å¯¹è±¡å†è¿›è¡Œæå–</li><li>.attr() # è¡¨ç¤ºè·å–æ ‡ç­¾</li><li>.text() # è¡¨ç¤ºè·å–æ–‡æœ¬</li></ul><pre><code class="python">&gt;&gt;&gt; from pyquery import PyQuery as pq</code></pre><pre><code class="python">&gt;&gt;&gt; query_data = pq(data[:])  # å› ä¸ºä¸ºäº†ä¾¿äºæå–,éœ€è¦åˆ é™¤èŠ‚ç‚¹,é¿å…ç ´åå…ƒæ•°æ®,æ‹·è´ä¸€ä»½</code></pre><pre><code class="python">&gt;&gt;&gt; poster = (i.attr[&quot;src&quot;] for i in query_data(&quot;a.nbg img&quot;).items())  # è·å–æµ·æŠ¥
&gt;&gt;&gt; other_name = [i.text() for i in query_data(&quot;div.pl2 a span&quot;).items()]  # è·å–åˆ«å
&gt;&gt;&gt; query_data(&quot;div.pl2 a span&quot;).remove()  # ç§»é™¤åˆ«åèŠ‚ç‚¹
&gt;&gt;&gt; movie_name = (i.text().strip(&quot;/&quot;).strip() for i in query_data(&quot;div.pl2 a&quot;).items())  # è·å–ç”µå½±å
&gt;&gt;&gt; time_actor =  (i.text() for i in query_data(&quot;div.pl2 p&quot;).items())  # è·å–ä¸Šæ˜ æ—¶é—´å’Œæ¼”å‘˜
&gt;&gt;&gt; score = (i.text() for i in query_data(&quot;span.rating_nums&quot;).items())  # è·å–è¯„åˆ†
&gt;&gt;&gt; comment_people = (i.text() for i in query_data(&quot;span.pl&quot;).items())  # è·å–è¯„ä»·äººæ•°
&gt;&gt;&gt; movie_data = {}</code></pre><pre><code class="python">for p, m, o, t, s, c in zip(poster, movie_name, other_name, time_actor, score, comment_people):
    release_time, actor = get_time_actor(t)
    movie_data.update({m: {&quot;poster&quot;: p, &quot;movie_name&quot;: m, &quot;other_name&quot;: t, &quot;release_time&quot;: release_time, &quot;actor&quot;: actor, &quot;score&quot;: s, &quot;comment&quot;: c}})
print(movie_data)</code></pre><pre><code>    {
    &#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;, &#39;movie_name&#39;: &#39;è¾›å¾·å‹’çš„åå•&#39;, &#39;other_name&#39;: &#39;1993-11-30(åç››é¡¿é¦–æ˜ ) / 1994-02-04(ç¾å›½) / è¿å§†Â·å°¼æ£® / æœ¬Â·é‡‘æ–¯åˆ© / æ‹‰å°”å¤«Â·è´¹å› æ–¯ / å¡ç½—ç³Â·å¤å¤šå°” / ä¹”çº³æ£®Â·è¨åŠ å°” / è‰¾ä¼¯ä¸Â·æˆ´ç»´å…¹ / é©¬å°”æˆˆè¨Â·æ ¼è´å°” / é©¬å…‹Â·ä¼Šç“¦æ¶… / ç¢§ç¿ æ–¯Â·é©¬ç§‘æ‹‰ / å®‰å¾·çƒˆÂ·ç‘ŸéŸ¦æ— / å¼—é‡Œå¾·é‡Œå¸ŒÂ·å†¯Â·å›¾æ© / å…‹é½æ–¯èŒ¨æ‰˜å¤«Â·æ‹‰å¤«ç‰¹...&#39;, &#39;release_time&#39;:
    ......
    }</code></pre><h2 id="5-scrapy-parsel-æ··åˆæå–"><a href="#5-scrapy-parsel-æ··åˆæå–" class="headerlink" title="5. scrapy/parsel æ··åˆæå–"></a>5. scrapy/parsel æ··åˆæå–</h2><blockquote><p>parselå·²ç»åˆ†ç¦»å‡ºæ¥ï¼Œå¯ä»¥ç›´æ¥ pip install æ•ˆæœä¸€æ ·ã€‚</p></blockquote><pre><code class="python">&gt;&gt;&gt; from scrapy import Selector  # å¯¼å…¥scrapyçš„é€‰æ‹©å™¨
&gt;&gt;&gt; # from parsel import Selector</code></pre><pre><code class="python">&gt;&gt;&gt; se = Selector(text=data)</code></pre><h4 id="æå–è§„åˆ™è¯´æ˜-ä»ä¸‹æ–¹æ¡ˆä¾‹å¯ä»¥çœ‹å‡º-scrapyçš„æå–å™¨-csså’Œxpath-ä»¥åŠæ­£åˆ™æå–éƒ½æ˜¯æ”¯æŒçš„-æˆ‘ä»¬å¯ä»¥æ··ç”¨"><a href="#æå–è§„åˆ™è¯´æ˜-ä»ä¸‹æ–¹æ¡ˆä¾‹å¯ä»¥çœ‹å‡º-scrapyçš„æå–å™¨-csså’Œxpath-ä»¥åŠæ­£åˆ™æå–éƒ½æ˜¯æ”¯æŒçš„-æˆ‘ä»¬å¯ä»¥æ··ç”¨" class="headerlink" title="æå–è§„åˆ™è¯´æ˜ ä»ä¸‹æ–¹æ¡ˆä¾‹å¯ä»¥çœ‹å‡º,scrapyçš„æå–å™¨,csså’Œxpath,ä»¥åŠæ­£åˆ™æå–éƒ½æ˜¯æ”¯æŒçš„,æˆ‘ä»¬å¯ä»¥æ··ç”¨"></a>æå–è§„åˆ™è¯´æ˜ ä»ä¸‹æ–¹æ¡ˆä¾‹å¯ä»¥çœ‹å‡º,scrapyçš„æå–å™¨,csså’Œxpath,ä»¥åŠæ­£åˆ™æå–éƒ½æ˜¯æ”¯æŒçš„,æˆ‘ä»¬å¯ä»¥æ··ç”¨</h4><ul><li>.css() # å°±æ˜¯cssè§„åˆ™çš„æå–</li><li>.xpath() # å°±æ˜¯xpathè§„åˆ™çš„æå–,éœ€è¦æ³¨æ„çš„æ˜¯,å› ä¸ºscrapyçš„Selectoræ”¯æŒæ··ç”¨,å¦‚æœxpathæ˜¯åœ¨æŸä¸ªæå–å™¨ä¹‹å,é‚£ä¹ˆå¿…é¡»ä½¿ç”¨â€./â€œæ¥è·Ÿè¿›ä¸Šä¸ªæå–å™¨çš„æå–ç‚¹,ä¸èƒ½ä½¿ç”¨â€//â€œ, å› ä¸ºSelector çš„xapthæå–å™¨çš„â€//â€œæ°¸è¿œä»£è¡¨æ ¹èŠ‚ç‚¹<ul><li>response.css(â€œ#idâ€).xpath(â€œ./aâ€) # è¯¥è§„åˆ™è¡¨ç¤ºid=â€idâ€ çš„èŠ‚ç‚¹<strong>ä¹‹å</strong>çš„æ‰€æœ‰aæ ‡ç­¾èŠ‚ç‚¹</li><li>response.css(â€œ#idâ€).xpath(â€œ//aâ€) # æ”¹è§„åˆ™å°±å˜æˆäº†æå–æ‰€æœ‰çš„aæ ‡ç­¾èŠ‚ç‚¹,å‰é¢çš„cssé€‰æ‹©å™¨çš„ç»“æœå¤±æ•ˆ.</li></ul></li><li>.re() # å°±æ˜¯æ­£åˆ™çš„æå–, æ­£åˆ™æå–å,ä¸éœ€è¦ç”¨extract()æ¥è½¬åŒ–æˆstrç±»å‹</li><li>extract() # å°†å½“å‰çš„é€‰æ‹©ç»“æœè½¬åŒ–æˆstrç±»å‹</li></ul><pre><code class="python">&gt;&gt;&gt; poster = se.css(&quot;.nbg img&quot;).xpath(&quot;./@src&quot;).extract()  # è·å–æµ·æŠ¥
&gt;&gt;&gt; movie_name = se.css(&quot;div.pl2&quot;).xpath(&quot;./a/text()&quot;).re(&quot;\w+&quot;)  # è·å–ç”µå½±å
&gt;&gt;&gt; other_name = se.css(&quot;div.pl2&quot;).xpath(&quot;./a/span/text()&quot;).extract()  # è·å–ç”µå½±åˆ«å
&gt;&gt;&gt; time_actor = se.css(&quot;div.pl2&quot;).xpath(&quot;./p/text()&quot;).extract()  # è·å–ä¸Šæ˜ æ—¥æœŸå’Œæ¼”å‘˜
&gt;&gt;&gt; score = se.css(&quot;span.rating_nums::text&quot;).extract()  # è·å–è¯„åˆ†
&gt;&gt;&gt; comment_people = se.xpath(&#39;//span[@class=&quot;pl&quot;]/text()&#39;).extract()  # è·å–è¯„åˆ†äººæ•°
&gt;&gt;&gt; movie_data = {}</code></pre><pre><code class="python">for p, m, o, t, s, c in zip(poster, movie_name, other_name, time_actor, score, comment_people):
    release_time, actor = get_time_actor(t)
    movie_data.update({m: {&quot;poster&quot;: p, &quot;movie_name&quot;: m, &quot;other_name&quot;: t, &quot;release_time&quot;: release_time, &quot;actor&quot;: actor, &quot;score&quot;: s, &quot;comment&quot;: c}})
print(movie_data)</code></pre><pre><code>    {
    &#39;è¾›å¾·å‹’çš„åå•&#39;: {&#39;poster&#39;: &#39;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.jpg&#39;, &#39;movie_name&#39;: &#39;è¾›å¾·å‹’çš„åå•&#39;, &#39;other_name&#39;: &#39;1993-11-30(åç››é¡¿é¦–æ˜ ) / 1994-02-04(ç¾å›½) / è¿å§†Â·å°¼æ£® / æœ¬Â·é‡‘æ–¯åˆ© / æ‹‰å°”å¤«Â·è´¹å› æ–¯ / å¡ç½—ç³Â·å¤å¤šå°” / ä¹”çº³æ£®Â·è¨åŠ å°” / è‰¾ä¼¯ä¸Â·æˆ´ç»´å…¹ / é©¬å°”æˆˆè¨Â·æ ¼è´å°” / é©¬å…‹Â·ä¼Šç“¦æ¶… / ç¢§ç¿ æ–¯Â·é©¬ç§‘æ‹‰ / å®‰å¾·çƒˆÂ·ç‘ŸéŸ¦æ— / å¼—é‡Œå¾·é‡Œå¸ŒÂ·å†¯Â·å›¾æ© / å…‹é½æ–¯èŒ¨æ‰˜å¤«Â·æ‹‰å¤«ç‰¹...&#39;, &#39;release_time&#39;: [&#39;1993-11-30(åç››é¡¿é¦–æ˜ )&#39;, &#39;1994-02-04(ç¾å›½)&#39;], &#39;actor&#39;: [&#39;è¿å§†Â·å°¼æ£®&#39;, &#39;æœ¬Â·é‡‘æ–¯åˆ©&#39;, &#39;æ‹‰å°”å¤«Â·è´¹å› æ–¯&#39;,
    ......
    }</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬è¯¥æ¬¡æå–ç»ƒä¹ çš„æ‰€æœ‰å†…å®¹,ä»¥è±†ç“£ç”µå½±top100çš„å“åº”ä¸ºä¾‹,æˆ‘ä»¬è®²è§£äº†å¸¸ç”¨çš„5ç§æå–å™¨.<br><strong>1. æ­£åˆ™</strong></p><ul><li>â€œ.â€ è¡¨ç¤ºä»»æ„éç©ºæ ¼æ¢è¡Œç­‰å­—ç¬¦</li><li>â€œ.*?â€ è¡¨ç¤ºè´ªå©ªåŒ¹é…,æœ€å°‘åŒ¹é…ä¸€æ¬¡</li><li>â€œ()â€ è¡¨ç¤ºæå–()ä¸­çš„å†…å®¹</li><li>â€œ\wâ€ è¡¨ç¤ºæ­£å¸¸å­—ç¬¦,æ¯”å¦‚è‹±æ–‡å­—æ¯,ä¸­æ–‡ç­‰å¸¸è§æ–‡å­—</li><li>â€œ.+â€ è¡¨ç¤ºè‡³å°‘åŒ¹é…ä¸€æ¬¡ä»»æ„å­—ç¬¦</li></ul><p><strong>2. css</strong></p><ul><li>â€œ.â€ è¡¨ç¤ºclass</li><li>â€œ â€œè¡¨ç¤ºå­å­™èŠ‚ç‚¹</li><li>img å°±æ˜¯imgèŠ‚ç‚¹</li><li>a å°±æ˜¯aèŠ‚ç‚¹</li><li>â€œ#abdâ€ è¡¨ç¤º id=â€abcâ€çš„èŠ‚ç‚¹</li></ul><p><strong>3. xpath</strong></p><ul><li>â€œ//â€œ # ä»£è¡¨ä»æ ¹èŠ‚ç‚¹æœç´¢</li><li>â€œ//aâ€ # æœç´¢æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰aæ ‡ç­¾</li><li>â€œ//a[@class=â€nbg]â€ # æœç´¢class=â€nbgâ€çš„aæ ‡ç­¾</li><li>â€œâ€¦/aâ€ # æœç´¢ä»â€¦èŠ‚ç‚¹å¼€å§‹çš„å­aæ ‡ç­¾</li><li>â€œâ€¦/img/@srcâ€ # è·å–å½“å‰imgæ ‡ç­¾çš„srcå±æ€§</li><li>â€œâ€¦/p/text()â€ # è·å–å½“å‰pæ ‡ç­¾ä¸‹çš„æ–‡æœ¬</li><li>â€œâ€¦/p//text()â€ # è·å–å½“å‰pæ ‡ç­¾åçš„æ‰€æœ‰æ–‡æœ¬(å­å­™æ–‡æœ¬)</li></ul><p><strong>4. pyquery</strong></p><ul><li>â€œa.nbgâ€ # è¡¨ç¤º a class=â€nbgâ€</li><li>â€œa imgâ€ # è¡¨ç¤º aæ ‡ç­¾çš„å­å­™imgæ ‡ç­¾</li><li>.remove() # è¡¨ç¤ºç§»é™¤è¯¥èŠ‚ç‚¹</li><li>.items() # å½“é€‰ä¸­å¤šä¸ªèŠ‚ç‚¹æ—¶,éœ€è¦ä½¿ç”¨.items() ç”Ÿæˆå¯éå†å¯¹è±¡å†è¿›è¡Œæå–</li><li>.attr() # è¡¨ç¤ºè·å–æ ‡ç­¾</li><li>.text() # è¡¨ç¤ºè·å–æ–‡æœ¬</li></ul><p><strong>5. æ··åˆæå–</strong></p><ul><li>.css() # å°±æ˜¯cssè§„åˆ™çš„æå–</li><li>.xpath() # å°±æ˜¯xpathè§„åˆ™çš„æå–,éœ€è¦æ³¨æ„çš„æ˜¯,å› ä¸ºscrapyçš„Selectoræ”¯æŒæ··ç”¨,å¦‚æœxpathæ˜¯åœ¨æŸä¸ªæå–å™¨ä¹‹å,é‚£ä¹ˆå¿…é¡»ä½¿ç”¨â€./â€œæ¥è·Ÿè¿›ä¸Šä¸ªæå–å™¨çš„æå–ç‚¹,ä¸èƒ½ä½¿ç”¨â€//â€œ, å› ä¸ºSelector çš„xapthæå–å™¨çš„â€//â€œæ°¸è¿œä»£è¡¨æ ¹èŠ‚ç‚¹<ul><li>response.css(â€œ#idâ€).xpath(â€œ./aâ€) # è¯¥è§„åˆ™è¡¨ç¤ºid=â€idâ€ çš„èŠ‚ç‚¹<strong>ä¹‹å</strong>çš„æ‰€æœ‰aæ ‡ç­¾èŠ‚ç‚¹</li><li>response.css(â€œ#idâ€).xpath(â€œ//aâ€) # æ”¹è§„åˆ™å°±å˜æˆäº†æå–æ‰€æœ‰çš„aæ ‡ç­¾èŠ‚ç‚¹,å‰é¢çš„cssé€‰æ‹©å™¨çš„ç»“æœå¤±æ•ˆ.</li></ul></li><li>.re() # å°±æ˜¯æ­£åˆ™çš„æå–, æ­£åˆ™æå–å,ä¸éœ€è¦ç”¨extract()æ¥è½¬åŒ–æˆstrç±»å‹</li><li>extract() # å°†å½“å‰çš„é€‰æ‹©ç»“æœè½¬åŒ–æˆstrç±»å‹<h4 id="å®Œæ•´ä»£ç -1"><a href="#å®Œæ•´ä»£ç -1" class="headerlink" title="å®Œæ•´ä»£ç "></a><a href="https://github.com/Dustyposa/goSpider/blob/master/spider_project/douban_movie/douban_spider.ipynb" target="_blank" rel="noopener">å®Œæ•´ä»£ç </a></h4></li></ul><p><b>æœ¬æ–‡åœ°å€ï¼š <a href="https://dustyposa.github.com/posts/841d9ffa/">https://dustyposa.github.com/posts/841d9ffa/</a></b></p></div><hr><div><p><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/%E7%BD%91%E7%BB%9C/">ç½‘ç»œ</a> &nbsp; <a class="hover-with-bg" href="/categories/%E7%BD%91%E7%BB%9C/%E6%8A%93%E5%8F%96/">æŠ“å–</a> &nbsp; <a class="hover-with-bg" href="/categories/%E7%BD%91%E7%BB%9C/%E6%8A%93%E5%8F%96/python/">python</a> &nbsp; </span>&nbsp;&nbsp; <span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/parser/">parser</a> <a class="hover-with-bg" href="/tags/spider/">spider</a></span></p><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0åè®®</a> ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext row"><div class="post-prev col-6"><a href="/posts/6f4644c4/"><i class="fa fa-chevron-left"></i> <span class="hidden-mobile">å¥‡å¦™çš„å¯¹è±¡æ¨¡å‹åŠå­˜å‚¨æ•°æ®æ¨¡å‹çš„æŠ€å·§</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></div><div class="post-next col-6"><a href="/posts/6e9446e6/"><span class="hidden-mobile">python ç¼–å†™å¤šè¿›ç¨‹ socket webé™æ€æœåŠ¡å™¨</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-chevron-right"></i></a></div></div></div><div class="comments" id="comments"><script defer src="https://utteranc.es/client.js" repo="Dustyposa/utterances_comments" issue-term="pathname" label="âœ¨ğŸ’¬âœ¨" theme="github-light" crossorigin="anonymous"></script></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc-start"></div><div id="toc"><p class="h5"><i class="far fa-list-alt"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div></main><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><b>Fluid</b></a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script><script>$(document).ready((function(){var t=$("#navbar").height(),o=$("#toc"),s=$("#board-ctn"),c=s.offset().top,i=2*c+s.height();$(window).scroll((function(){var s=$("#toc-start").offset().top-t,c=document.body.scrollTop+document.documentElement.scrollTop;s<=c&&c<=i?o.css({display:"block",position:"fixed",top:t}):c<=s?o.css({position:"",top:""}):c>i&&o.css("display","none")})),tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,headingsOffset:-c}),$(".toc-list-item").length>0&&$("#toc > p").css("visibility","visible");var l=s.css("margin-right");$("#toc-ctn").css({right:l})}))</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-163481315-1","auto"),ga("send","pageview")</script><script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script><script>$(document).ready((function(){$("pre").addClass("prettyprint  "),prettyPrint()}))</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","python è¯·æ±‚åˆ†æåŠå¤šæå–å™¨ æå–æ•°æ®&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready((function(){$(".typed-cursor").addClass("h2"),typed.start()}))</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options={placement:"right",visible:"hover",icon:"â¡"};var el="h1,h2,h3,h4,h5,h6".split(","),res=[];for(item of el)res.push(".markdown-body > "+item);anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#post img:not(.no-zoom img, img[no-zoom])").each((function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)}))</script><script>!function(e,t,a){function r(e){var a=t.createElement("div");a.className="heart",n.push({el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),t.body.appendChild(a)}var n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(e){var a=t.createElement("style");a.type="text/css";try{a.appendChild(t.createTextNode(e))}catch(t){a.styleSheet.cssText=e}t.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),function(){var t="function"==typeof e.onclick&&e.onclick;e.onclick=function(e){t&&t(),r(e)}}(),function e(){for(var a=0;a<n.length;a++)n[a].alpha<=0?(t.body.removeChild(n[a].el),n.splice(a,1)):(n[a].y--,n[a].scale+=.004,n[a].alpha-=.013,n[a].el.style.cssText="left:"+n[a].x+"px;top:"+n[a].y+"px;opacity:"+n[a].alpha+";transform:scale("+n[a].scale+","+n[a].scale+") rotate(45deg);background:"+n[a].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/ni-j.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>