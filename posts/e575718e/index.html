<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="一些经验的记录。"><meta name="author" content="Dusty Posa"><meta name="keywords" content="python,python3,process,script"><title>从零开始搭建Github博客(其二) - Posaのにわ</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"><link rel="stylesheet" href="/css/main.css"><link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Posaのにわ</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/">标签</a></li><li class="nav-item"><a class="nav-link" href="/about/">关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(https://i.loli.net/2020/04/14/smYH5uD8Pb7k4oI.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask rgba-black-light flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><p class="mt-3 post-meta"><i class="fas fa-calendar-alt" aria-hidden="true"></i> 星期四, 四月 9日 2020, 10:28 上午</p><p class="mt-1"><span class="post-meta"><i class="far fa-chart-bar"></i> 3.6k 字 </span><span class="post-meta"><i class="far fa-clock"></i> 13 分钟</span></p></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><p class="note note-warning">本文最后更新于：星期四, 五月 14日 2020, 3:19 下午</p><div class="markdown-body"><h1 id="搭建-github-博客之旅-（Part-2）"><a href="#搭建-github-博客之旅-（Part-2）" class="headerlink" title="搭建 github 博客之旅 （Part 2）"></a>搭建 github 博客之旅 （Part 2）</h1><p>在第一部分，我们介绍了如何搭建一个免费博客并部署在 <code>Github</code> 上面，但是我们还有很多可以优化（更懒）的地方，例如：</p><ul><li><a href="#自动化部署-CI-CD">自动部署（非一键部署）</a></li><li><a href="#更换主题">主题更换（换个漂亮的皮肤）</a></li><li><a href="#性能优化">性能优化（带宽，响应太慢？）</a></li><li>加点料<ul><li><a href="#icon-生成">icon 制作</a></li><li><a href="#流程图支持">增强表现力-流程图支持</a></li><li><a href="#评论支持">来点评论</a></li><li><a href="#增加看板娘">看板娘来了</a></li><li><a href="#增加永久链接">永久链接</a></li></ul></li></ul><p>那么，话不多说，开始正题。</p><h2 id="自动化部署-CI-CD"><a href="#自动化部署-CI-CD" class="headerlink" title="自动化部署-CI/CD"></a>自动化部署-CI/CD</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>我们简述一下我们目前的部署流程：</p><blockquote><p>在 writing 编写文章, 编写完成后，运行<br><code>$ hexo g &amp; d</code><br>长篇文章写好之后，这点操作没什么太大负担，但是如果进行小调整的话每次都要输这些命令，那就很麻烦了。<br>那么我们思考一下，写完文章后输入命令发布，<br>命令是不变的，那么我们这里肯定可以<strong>自动化</strong>。<br>那么，关键问题是如何确定文章写完了？毕竟不可能每次写一半，或者写一点就自动发布，我们就需要一个<strong>自动发布触发点</strong>。<br><code>git</code> 比较好想，我们触发点使用 <code>push</code> 或者 分支更新即可。<br>看起来很简单，如何实现呢？<br>这时候就可以祭出我们的利器了 - <code>Travis Ci</code>！</p></blockquote><details><summary>CI/CD 是什么?</summary><p>这里自动部署，用到了一个概念 <code>CI/CD (持续集成/持续部署)</code>。<br>简单来说，就是让开发部署自动化，我们设置一个流程，对每次发布后的代码都进行相同的操作（比如：运行测试之类，当然测试完成后，我们也可以自动合并或者自动部署）。<br>这里，我们的项目比较简单，我们做到自动部署即可。让我们管理博客更加轻松。</p><blockquote><p>wiki解释：<br>在软件工程中，CI / CD或CICD通常是指持续集成与持续交付或持续部署的组合实践。在企业沟通的上下文中，CI / CD还可以指代企业标识和企业设计的整个过程。</p></blockquote></details><h3 id="Travis-Ci-安装"><a href="#Travis-Ci-安装" class="headerlink" title="Travis Ci 安装"></a>Travis Ci 安装</h3><h4 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h4><details><summary>Travis 是什么</summary><blockquote><p>Travis CI是在软件开发领域中的一个在线的，分布式的持续集成服务，用来构建及测试在GitHub托管的代码。这个软件的代码同时也是开源的，可以在GitHub上下载到，尽管开发者当前并不推荐在闭源项目中单独使用它</p></blockquote><p>简单的说，就是针对 <code>GitHub</code> 的 <code>CI</code>，也就是我们要的 <code>CI</code> 工具了，你应该也在很多仓库看到过这个工具，一般就叫 <code>traviscibot</code>。<br>like this：<br><img src="https://i.loli.net/2020/04/09/RkIPD9piuQjCfG3.png" srcset="/img/loading.gif" alt="image.png"></p></details><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul><li><h4 id="a-把-Travis-CI-添加到你的-GitHub-账户中。"><a href="#a-把-Travis-CI-添加到你的-GitHub-账户中。" class="headerlink" title="a. 把 Travis CI 添加到你的 GitHub 账户中。"></a>a. 把 <code>Travis CI</code> 添加到你的 <code>GitHub</code> 账户中。</h4>打开 <a href="https://github.com/marketplace/travis-ci" target="_blank" rel="noopener">Travis CI</a> 安装页面。<br>选择免费安装（只适合于开源项目）<br><img src="https://i.loli.net/2020/04/09/HfkOcwTMa2sVWJ8.png" srcset="/img/loading.gif" alt="image.png"></li></ul><ul><li><h4 id="b-配置-Travis-CI-权限。"><a href="#b-配置-Travis-CI-权限。" class="headerlink" title="b. 配置 Travis CI 权限。"></a>b. 配置 <code>Travis CI</code> 权限。</h4><p>前往 <code>GitHub</code> 的 <a href="https://github.com/settings/installations" target="_blank" rel="noopener">Applications settings</a>，配置 <code>Travis CI</code> 权限，使其能够访问你的 <code>repository</code>。</p><blockquote><p><img src="https://i.loli.net/2020/04/11/aNkuiDx9AnSqdby.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote><p>你应该会被重定向到 <code>Travis CI</code> 的页面。如果没有，请 <a href="https://travis-ci.com/" target="_blank" rel="noopener">手动前往</a>。</p><p>在浏览器新建一个标签页，前往 GitHub 新建 <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">Personal Access Token</a>，只勾选 <code>repo</code> 的权限并保存。<code>Token</code> 生成后请复制并保存好。</p><blockquote><p><img src="https://i.loli.net/2020/04/11/H5nNtPu8s6RVx3B.png" srcset="/img/loading.gif" alt="image.png"></p><p>回到 <code>Travis CI</code>，前往你的 <code>repository</code> 的设置页面，在 <strong>Environment Variables</strong> 下新建一个环境变量，<strong>Name</strong> 为 <code>GH_TOKEN</code>，<strong>Value</strong> 为刚才你在 GitHub 生成的 Token。确保 <strong>DISPLAY VALUE IN BUILD LOG</strong> 保持 <strong>不被勾选</strong> 避免你的 Token 泄漏。点击 <code>Add</code> 保存。<br>设置页面在这里进：<br><img src="https://i.loli.net/2020/04/10/A1ZGmkyTudVjWfz.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote></li></ul><ul><li><h4 id="c-编写自动部署脚本"><a href="#c-编写自动部署脚本" class="headerlink" title="c. 编写自动部署脚本"></a>c. 编写自动部署脚本</h4><p>在<strong>根目录</strong>新建一个 <code>.travis.yml</code> 的文件:</p><pre><code class="yaml"> sudo: false
language: node_js
node_js:
    - 10 # use nodejs v10 LTS
cache: npm
install:
    - cd docs &amp;&amp; npm i
# 限制使用 travis 的分支
branches:
    only:
        - writing
script:
    - hexo clean
    - hexo generate # generate static files
deploy:
    provider: pages
    skip-cleanup: true
    github-token: $GH_TOKEN
    target-branch: master  # 目标分支
    keep-history: true
    on:
      branch: writing  # 在哪个分支运行脚本
    local-dir: docs/public  # 部署的文件夹
</code></pre><p>这样在我们的自动部署就差不多完成了，我们将配置好的文件 <code>push</code> 上去。稍等片刻，就能看到自动部署详情了（可以到 <code>Travis CI</code> 中看详细日志）。<br>在我们的 <code>master</code> 分支页面就能看到机器人了~</p><blockquote><p><img src="https://i.loli.net/2020/04/09/RkIPD9piuQjCfG3.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote></li></ul><h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><p>默认主题的 <code>hexo</code> 比较单调，一点都不炫酷。自然，换肤的需求就诞生了。到现在，<code>hexo</code> 也有了很多炫酷的主题可选，在这里，我推荐一个 <code>Material Design</code> 风格的主题 <a href="https://hexo.fluid-dev.com/docs/guide/#%E4%B8%BB%E9%A2%98%E7%AE%80%E4%BB%8B" target="_blank" rel="noopener"><code>flud</code></a><br>当然也有很多其他主题可选，在<a href="https://hexo.io/themes/" target="_blank" rel="noopener">这里</a>可以看，使用方式基本一致，依葫芦画瓢即可。</p><h3 id="安装-flud"><a href="#安装-flud" class="headerlink" title="安装 flud"></a>安装 flud</h3><p>下载 <a href="https://github.com/fluid-dev/hexo-theme-fluid/releases" target="_blank" rel="noopener">最新 release 版本</a>，<code>master</code> 分支无法保证稳定。<br>下载后解压到 <code>themes</code> 目录下并重命名为 <code>fluid</code>。<br>结果如下图：<br><img src="https://i.loli.net/2020/04/09/IaOnpSDxCGYFeUK.png" srcset="/img/loading.gif" alt="image.png"></p><h3 id="更换主题-1"><a href="#更换主题-1" class="headerlink" title="更换主题"></a>更换主题</h3><p>更换主题也很简单，我们更改 <code>hexo</code> 配置文件即可。<br>打开 <code>docs/_config.yml</code> (即博客目录下的该配置文件),更改下面的配置：</p><pre><code>
theme: fluid  # 指定主题

language: zh-CN  # 指定语言，可不改</code></pre><p>这样我们重新运行<br><code>hexo s</code><br>就能看到我们新的主题了！参考效果如下：</p><blockquote><p><img src="https://i.loli.net/2020/04/11/fvBIEbJsaukDd26.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote><p>整个操作也很简单，但是需要定制化操作的话，看<a href="https://hexo.fluid-dev.com/docs/guide" target="_blank" rel="noopener">官方文档</a>即可～非常详细。</p><h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>由于我们的带宽是有限的，那么如果传递的资源太大，响应就会很慢。大家可以测试一下，<strong>更换一下</strong> <code>banner</code> 图片，<strong>部署</strong>后再次访问，就会发现很慢很慢。这也非常影响用户体验。</p><p>那么如何解决呢？<br>很明显，我们至少有两种解决办法：</p><ul><li><del>a. 加带宽</del> （什么？加带宽？那是不可能的，服务器都是白嫖的，还想我加带宽？？？）</li><li>b. 减少从<strong>自身</strong>服务器传输的数据量（注意加粗部分）<br>这里我们可以再分出两种思路<ul><li><strong>1. 减少自身服务器传输的数据大小（例如: 文本文件数据，图片数据之类）</strong></li><li><strong>2. 将数据放到其他地方，远程获取（例如： CDN，文件服务器，图床等等）</strong></li></ul></li></ul><p>那么，我们就简单介绍一下这两种方法，顺便对我们的博客网站进行优化。</p><h3 id="文件压缩"><a href="#文件压缩" class="headerlink" title="文件压缩"></a>文件压缩</h3><h4 id="a-文本文件压缩"><a href="#a-文本文件压缩" class="headerlink" title="a. 文本文件压缩"></a>a. 文本文件压缩</h4><p>这个我们列举一种方式，用压缩插件完成即可。</p><ul><li><p>安装插件 <code>hexo-all-minifier</code></p><pre><code>npm install hexo-all-minifier --save</code></pre><blockquote><p>mac 用户可能需要安装其他东西<br><code>brew install libtool automake autoconf nasm</code></p></blockquote></li><li><p>开启插件<br>在博客配置文件中加入</p><pre><code>all_minifier: true</code></pre><p>我们在运行 <code>hexo g</code> 或者部署即可看到效果，<code>js,css</code> 等文件都被压缩了。</p><blockquote><p>压缩详细配置可参考文档：<br><a href="https://github.com/chenzhutian/hexo-all-minifier" target="_blank" rel="noopener">hexo_all_minifier</a></p></blockquote></li></ul><h3 id="图片压缩以及存储"><a href="#图片压缩以及存储" class="headerlink" title="图片压缩以及存储"></a>图片压缩以及存储</h3><h4 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h4><p>我们的文件压缩了，大一点图片怎么办呢？（比如图片就有：1M， 这样我们网站加载也会很慢）<br>当然图片也可以直接通过 <code>js</code> 来压缩，但是压缩品质可能不太好。我们换一种服务，<a href="https://tinyjpg.com/" target="_blank" rel="noopener">tinyjpg</a><br>使用也很简单，把要压缩的图片放上去，压缩后下载回来即可，我们就不阐述了。</p><h4 id="图片存储"><a href="#图片存储" class="headerlink" title="图片存储"></a>图片存储</h4><p>那么图片有了，我们应该把图片放哪里呢？放本地？不大好，毕竟<strong>带宽很慢，也浪费资源。</strong><br>这里我们推荐一种通用方式，<code>CDN or 图床 or 文件存储服务之类</code>。这里我们选用<strong>图床</strong>，其他的都大同小异。<br>图床有很多可以选择的，因为图片比较少，我就推荐一个我目前使用的图床。<a href="https://sm.ms/" target="_blank" rel="noopener">MS</a></p><blockquote><p>图床是什么？<br>简单的说就是一个专门用来放图片的地方，图片在图床服务的服务器。<br>好处是？<br>图片在别的服务器，当然就不会占用我们服务器的带宽，有些图床还支持 <code>CDN</code> 速度能更快。<br>另外，图片管理也更方便，平时的图片都可以存上面（非隐私图片）。</p></blockquote><p>使用那就很简单了，我们把图片上传到图床即可。上传之后大致可以得到如图效果：</p><blockquote><p><img src="https://i.loli.net/2020/04/10/PrDiS9lLkMfWJ7V.png" srcset="/img/loading.gif" alt="image.png"></p></blockquote><p>常用的链接一般就这两个～一个是绝对链接，一个是 <code>Markdown</code> 语法的，复制到 <code>md</code> 文件中就能看到效果了。</p><p>综上，合理<strong>压缩和利用图床</strong>等存储服务，能<strong>极大的提升我们的博客响应速度</strong>。降低服务器压力～将用户体验提升到极致。（当然任何服务都可以酌情应用该方案，不止博客！）</p><h3 id="小插曲"><a href="#小插曲" class="headerlink" title="小插曲"></a>小插曲</h3><p><strong>ちょっと待って，不对不对，你这不是套我嘛？浏览者的用户体验提升了，但是写作者的用户体验没提升呀，还要传来传去，跳来跳去，多麻烦。</strong><br>没错！这个问题，我们当然也能优化！怎么做？<br><strong>等下回咯</strong>（逃，不要打我</p><p>到这里结束了嘛？当然没有，我们再加一点其他的小插件。</p><h2 id="icon-生成"><a href="#icon-生成" class="headerlink" title="icon 生成"></a>icon 生成</h2><p>不知道大家发现没有，我博客的 <code>icon</code> 变了！！<br><strong>5分钟</strong>搞定的。<br>How to do?<br>来试试我们的神奇的<a href="https://favicon.io" target="_blank" rel="noopener">网站</a>, 网站比较简单，专门用来做 <code>icon</code>, 怎么使用网站就不介绍了，我们介绍一下如何替换自己网站的 <code>icon</code>。<br>我们主要需要这个文件：</p><pre><code>favicon.png</code></pre><p>在网站生成的<code>压缩包</code>中可以找到。<br>我们把它放入和 <code>_posts</code> 文件夹同级的 <code>img</code> 文件夹中即可。<br>大概如下图：</p><pre><code>├── _post
├── img
|   ├── favicon.png</code></pre><p>就是这么简单～</p><h2 id="流程图支持"><a href="#流程图支持" class="headerlink" title="流程图支持"></a>流程图支持</h2><p>为了增强文章的表达力，我们有时候也会在文章中加入一些<strong>流程图</strong>就像这样：</p><div class="mermaid">graph TD; A-->B; A-->C; B-->D; C-->D;</div>那么如何做呢？只需要 **4步**：<h4 id="1-安装-hexo-filter-mermaid-diagrams-插件"><a href="#1-安装-hexo-filter-mermaid-diagrams-插件" class="headerlink" title="1. 安装 hexo-filter-mermaid-diagrams 插件"></a>1. 安装 <code>hexo-filter-mermaid-diagrams</code> 插件</h4><pre><code>npm i hexo-filter-mermaid-diagrams # or yarn install hexo-filter-mermaid-diagrams</code></pre><h4 id="2-配置-ejs"><a href="#2-配置-ejs" class="headerlink" title="2. 配置 ejs"></a>2. 配置 <code>ejs</code></h4><p>因为我们的流程图之类主要在文章中使用，所以我们只给文章页面配置该功能。<br>找到该文件 <code>post.ejs</code>:</p><pre><code>├── themes
|    ├── fluid  # 你的使用的主题的文件夹
|           ├── layout
|                   ├── post.ejs</code></pre><p>在文件末尾加上以下代码：</p><pre><code class="ejs">&lt;!-- Mermaid --&gt;
&lt;% if (page.mermaid &amp;&amp; theme.post.mermaid.enable) { %&gt;
  &lt;script src=&quot;&lt;%- url_for(theme.post.mermaid.cdn) %&gt;&quot;&gt;&lt;/script&gt;
  &lt;script&gt;
    if (window.mermaid) {
      mermaid.initialize(&lt;%- JSON.stringify(theme.post.mermaid.options) %&gt;);
    }
  &lt;/script&gt;
&lt;% } %&gt;</code></pre><p>在主题配置文件的 <code>post</code> 配置中，大概这个位置：<br><img src="https://i.loli.net/2020/04/12/IrSOQmKZAujbW7x.png" srcset="/img/loading.gif" alt="image.png"></p><p>加入以下代码：</p><pre><code class="yaml">mermaid: ## mermaid url https://github.com/knsv/mermaid
  enable: true  # default true
  specific: false
  cdn: https://cdn.jsdelivr.net/npm/mermaid@7/dist/mermaid.min.js
  options:  # find more api options from https://github.com/knsv/mermaid/blob/master/src/mermaidAPI.js
    theme: forest</code></pre><p class="note note-info"><b>简单的性能优化</b>：<br>由于不是每篇文章都要流程图之类以及该功能需要<b>加载</b>额外的 <code>js</code> 文件，所以我们设置了一个开关，来让文章决定是否开启加载。</p><h4 id="3-开启-mermaid-渲染"><a href="#3-开启-mermaid-渲染" class="headerlink" title="3. 开启 mermaid 渲染"></a>3. 开启 mermaid 渲染</h4><p>主要要在文章文件 <code>xxx.md</code> 的顶部加上：</p><pre><code class="yaml">mermaid: true</code></pre><p>这样我们的这篇文章就会<strong>加载</strong>渲染流程图需要的 <code>js</code> 文件， 如果不设置，文章就<strong>不会加载</strong>相关 <code>js</code> 文件。</p><p><code>md</code> 文件的参考头部如下：</p><blockquote><p>-–<br>title: 从零开始搭建Github博客(其二)<br>tags: [github_pages, hexo]<br>category: [blog]<br>date: 2020-04-09 10:28:39<br><strong>mermaid: true</strong><br>-–</p></blockquote><h4 id="4-在文章中加入流程图语法"><a href="#4-在文章中加入流程图语法" class="headerlink" title="4. 在文章中加入流程图语法"></a>4. 在文章中加入流程图语法</h4><p>完成上面的设置之后，就完成了大半了，但是我们的 <code>md</code> 文件中中还没有流程图语法。<br>流程图语法也比较简单，<strong><code>md</code></strong> 文件中的任意位置加入以下代码即可：</p><pre><code class="html">&lt;div class=&quot;mermaid&quot;&gt; 
graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
&lt;/div&gt;</code></pre><p>这样就更能增强文章的表达力了～赶快试一试吧！</p><h2 id="utterances-评论支持"><a href="#utterances-评论支持" class="headerlink" title="utterances 评论支持"></a><code>utterances</code> 评论支持</h2><p>评论支持比较简单，参考这篇文章就行。<br><a href="https://litstronger.github.io/2020/04/03/hexo-fluid%E6%B7%BB%E5%8A%A0utterances%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/" target="_blank" rel="noopener">评论支持</a></p><p class="note note-danger"><b>下面部分请根据自己的主题及参考代码酌情设置!!!!</b></p><p>但是开启评论的话参考 <code>post.ejs</code> 部分，具体代码如下(主要是<strong>第一行</strong>)：</p><pre><code class="js">&lt;% if(page.comments &amp;&amp; theme.post.comments.enable) { %&gt;
                &lt;!-- Comments --&gt;
                &lt;div class=&quot;comments&quot; id=&quot;comments&quot;&gt;
                  &lt;% var type = &#39;_partial/comments/&#39; + theme.post.comments.type %&gt;
                  &lt;%- partial(type) %&gt;
                &lt;/div&gt;
              &lt;% } %&gt;</code></pre><p>由上面代码可得，如果要开启评论还需要在每篇文章的头部加上</p><pre><code>comments: true</code></pre><p>才会开启，不是很方便，所以我们做一下粒度控制。</p><h3 id="粒度控制"><a href="#粒度控制" class="headerlink" title="粒度控制"></a>粒度控制</h3><p class="note note-info">主要是方便我们开启全局都允许评论，忽略文章头部的设置。因为大多数文章都是开启评论，小部分可能需要关闭评论，所以我们就用来用代码控制这小部分情况。</p><h4 id="1-在主题配置文件中的-post-comments-中加入一个粒度开关-postCheck："><a href="#1-在主题配置文件中的-post-comments-中加入一个粒度开关-postCheck：" class="headerlink" title="1. 在主题配置文件中的 post.comments 中加入一个粒度开关 postCheck："></a>1. 在主题配置文件中的 <code>post.comments</code> 中加入一个粒度开关 <code>postCheck</code>：</h4><pre><code class="yaml">post:
  ...
    comments:  
        ...
        postCheck: false</code></pre><h4 id="2-更改-post-ejs-配置"><a href="#2-更改-post-ejs-配置" class="headerlink" title="2. 更改 post.ejs 配置"></a>2. 更改 <code>post.ejs</code> 配置</h4><p>更改参考如下：</p><pre><code class="js">&lt;% if((!theme.post.comments.postCheck || page.comments) &amp;&amp; theme.post.comments.enable) { %&gt;</code></pre><p>这样，当我们设置 <code>postCheck: false</code> 时，所有文章都会<strong>开启评论</strong>。<br>而当我们设置 <code>postCheck: true</code> 同时如果文章头部设置了: <code>comments: false</code> 时，该篇文章就会<strong>禁用</strong>评论功能了~</p><h2 id="增加看板娘"><a href="#增加看板娘" class="headerlink" title="增加看板娘"></a>增加看板娘</h2><p>就是我的博客右下角那 <strong>萌小子</strong><br>实现也很简单，参考 <a href="https://github.com/EYHN/hexo-helper-live2d" target="_blank" rel="noopener">这里</a>即可</p><p class="note note-info">有一点需要注意:可以将官方的两种配置混合使用</p><h2 id="增加永久链接"><a href="#增加永久链接" class="headerlink" title="增加永久链接"></a>增加永久链接</h2><p>因为目前我们的文章链接<strong>不是固定的</strong>，所以分享给别人的时候链接会<strong>失效</strong>，所以有了这个插件，就可以<strong>固定</strong>住我们的文章链接了。<br>安装模块：</p><pre><code class="bash">npm install hexo-abbrlink --save</code></pre><p>更改配置:<br>全局搜索 <code>permalink</code>,然后更改为</p><pre><code class="yml">permalink: posts/:abbrlink/
# 下面的为需要添加的
abbrlink:
  alg: crc32  # support crc16(default) and crc32
  rep: hex  # Represent (the generated link could be presented in hex or dec value)</code></pre><p><em>具体作用可以参看<a href="https://github.com/rozbo/hexo-abbrlink" target="_blank" rel="noopener">文档</a></em></p><p>开启测试：<br>命令行界面输入</p><pre><code class="bash">hexo clean  # 这部比较关键
hexo s # 重启服务</code></pre><p>就可以看到我们的网站链接都变成了固定的短链接了。</p><p class="note note-info">可能遇到的情况是文章没有生成短链接，那是由于文章头部加了 <code>layout: xxx</code>，<b>删除</b>该配置即可。</p><h2 id="下一章混入：音乐播放器"><a href="#下一章混入：音乐播放器" class="headerlink" title="下一章混入：音乐播放器"></a>下一章混入：音乐播放器</h2><p><a href="https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md" target="_blank" rel="noopener">WAITING TO SET</a><br>next part</p><blockquote><p>参考资料：<br><a href="https://hexo.io/zh-cn/docs/github-pages" target="_blank" rel="noopener">hexo 文档</a><br><a href="https://hexo.fluid-dev.com/docs" target="_blank" rel="noopener">fluid 文档</a><br><a href="https://github.com/chenzhutian/hexo-all-minifier" target="_blank" rel="noopener">hexo_all_minifier 文档</a><br><a href="https://github.com/webappdevelp/hexo-filter-mermaid-diagrams" target="_blank" rel="noopener">hexo-filter-mermaid-diagrams</a><br><a href="https://litstronger.github.io/2020/04/03/hexo-fluid%E6%B7%BB%E5%8A%A0utterances%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/" target="_blank" rel="noopener">评论支持</a><br><a href="https://github.com/rozbo/hexo-abbrlink" target="_blank" rel="noopener">固定链接</a></p></blockquote><p><b>本文地址： <a href="https://dustyposa.github.com/posts/e575718e/">https://dustyposa.github.com/posts/e575718e/</a></b></p></div><hr><div><p><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/blog/">blog</a> &nbsp; </span>&nbsp;&nbsp; <span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/github-pages/">github_pages</a> <a class="hover-with-bg" href="/tags/hexo/">hexo</a></span></p><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p><div class="post-prevnext row"><div class="post-prev col-6"><a href="/posts/173aa14f/"><i class="fa fa-chevron-left"></i> <span class="hidden-mobile">pytest 之旅(Part:1)（ing 未写完，慎点）</span> <span class="visible-mobile">上一篇</span></a></div><div class="post-next col-6"><a href="/posts/4a44eaec/"><span class="hidden-mobile">从零开始搭建Github博客(其一)</span> <span class="visible-mobile">下一篇</span> <i class="fa fa-chevron-right"></i></a></div></div></div><div class="comments" id="comments"><script defer src="https://utteranc.es/client.js" repo="Dustyposa/utterances_comments" issue-term="pathname" label="✨💬✨" theme="github-light" crossorigin="anonymous"></script></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc-start"></div><div id="toc"><p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@7/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></main><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div id="aplayer"></div><script defer src="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.css"><script type="text/javascript">var oldLoad=window.onload;window.onload=function(){new APlayer({container:document.getElementById("aplayer"),fixed:!0,autoplay:!1,loop:"all",order:"random",theme:"#b7daff",preload:"none",audio:[{name:"残酷な天使のテーゼ",artist:"高橋洋子",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_5130573&response=res&type=convert_url&",cover:"http://p1.music.126.net/45hISoQHiPTbPg9oapc7DQ==/109951163549396167.jpg?param=300x300"},{name:"Lemon",artist:"米津玄師",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_51573181&response=res&type=convert_url&",cover:"http://p2.music.126.net/6IeZ9MiSSDXifj74nzH6ww==/109951163561494000.jpg?param=300x300"},{name:"会いたいよ",artist:"手塚翔太",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_72890829&response=res&type=convert_url&",cover:"http://p2.music.126.net/4e3vc5Ln8LDAaFhDIQ3edA==/109951164200567437.jpg?param=300x300"},{name:"Letter Song",artist:"ヲタみん",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_27876755&response=res&type=convert_url&",cover:"http://p1.music.126.net/zJae2lg6igf-mBb5vbecew==/3099523278777600.jpg?param=300x300"},{name:"僕が死のうと思ったのは",artist:"中島美嘉",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_7006766&response=res&type=convert_url&",cover:"http://p1.music.126.net/HE-K4mxyNGF84xlyuxx9Wg==/109951163825342747.jpg?param=300x300"},{name:"光るなら",artist:"Goose house",url:"http://antiserver.kuwo.cn/anti.s?useless=/resource/&format=mp3&rid=MUSIC_6400506&response=res&type=convert_url&",cover:"http://p2.music.126.net/TM6SM2-ppcd1F66YyjR-Eg==/2537672838610591.jpg?param=300x300"}]}),oldLoad&&oldLoad()}</script><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><b>Fluid</b></a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script><script>$(document).ready(function(){var s=$("#navbar").height(),c=$("#toc"),t=$("#board-ctn"),o=t.offset().top,i=2*o+t.height();$(window).scroll(function(){var t=$("#toc-start").offset().top-s,o=document.body.scrollTop+document.documentElement.scrollTop;t<=o&&o<=i?c.css({display:"block",position:"fixed",top:s}):o<=t?c.css({position:"",top:""}):i<o&&c.css("display","none")}),tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,headingsOffset:-o}),0<$(".toc-list-item").length&&$("#toc > p").css("visibility","visible");var l=t.css("margin-right");$("#toc-ctn").css({right:l})})</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-163481315-1","auto"),ga("send","pageview")</script><script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script><script>$(document).ready(function(){$("pre").addClass("prettyprint  "),prettyPrint()})</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","从零开始搭建Github博客(其二)&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "❡"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#post img:not(.no-zoom img, img[no-zoom])").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><script>!function(e,r,t){var o,n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(t){var a=r.createElement("style");a.type="text/css";try{a.appendChild(r.createTextNode(t))}catch(e){a.styleSheet.cssText=t}r.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o="function"==typeof e.onclick&&e.onclick,e.onclick=function(e){var t,a;o&&o(),t=e,(a=r.createElement("div")).className="heart",n.push({el:a,x:t.clientX-5,y:t.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),r.body.appendChild(a)},function e(){for(var t=0;t<n.length;t++)n[t].alpha<=0?(r.body.removeChild(n[t].el),n.splice(t,1)):(n[t].y--,n[t].scale+=.004,n[t].alpha-=.013,n[t].el.style.cssText="left:"+n[t].x+"px;top:"+n[t].y+"px;opacity:"+n[t].alpha+";transform:scale("+n[t].scale+","+n[t].scale+") rotate(45deg);background:"+n[t].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/ni-j.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>